alert udp any any -> $HOME_NET 139 (msg:"NETBIOS Microsoft Windows NETAPI堆栈溢出入站-MS08-067（1）";content:"|0B|";offset:2;depth:1;content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008690;classtype:attempted-admin;sid:2008690;rev:5;metadata:alarm_type 漏洞利用;)
alert udp any any -> $HOME_NET 139 (msg:"NETBIOS Microsoft Windows NETAPI堆栈溢出入站-MS08-067（2）";content:"|1F 00|";content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|";content:"..|5C|..|5C|";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008691;classtype:attempted-admin;sid:2008691;rev:6;metadata:alarm_type 漏洞利用;)
alert udp any any -> $HOME_NET 139 (msg:"NETBIOS Microsoft Windows NETAPI堆栈溢出入站-MS08-067（3）";content:"|1F 00|";content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|";content:"../../";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008692;classtype:attempted-admin;sid:2008692;rev:5;metadata:alarm_type 漏洞利用;)
alert udp any any -> $HOME_NET 139 (msg:"NETBIOS Microsoft Windows NETAPI堆栈溢出入站-MS08-067（4）";content:"|1F 00|";content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|";content:"|00 2E 00 2E 00 2F 00 2E 00 2E 00 2F|";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008693;classtype:attempted-admin;sid:2008693;rev:5;metadata:alarm_type 漏洞利用;)
alert udp any any -> $HOME_NET 139 (msg:"NETBIOS Microsoft Windows NETAPI堆栈溢出入站-MS08-067（5）";content:"|1F 00|";content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|";content:"|00 2E 00 2E 00 5C 00 2E 00 2E 00 5C|";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008694;classtype:attempted-admin;sid:2008694;rev:5;metadata:alarm_type 漏洞利用;)
alert udp any any -> $HOME_NET 139 (msg:"NETBIOS Microsoft Windows NETAPI堆栈溢出入站-MS08-067（7）";content:"|20 00|";content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|";content:"..|5C|..|5C|";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008696;classtype:attempted-admin;sid:2008696;rev:6;metadata:alarm_type 漏洞利用;)
alert udp any any -> $HOME_NET 139 (msg:"NETBIOS Microsoft Windows NETAPI堆栈溢出入站-MS08-067（8）";content:"|20 00|";content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|";content:"../../";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008697;classtype:attempted-admin;sid:2008697;rev:5;metadata:alarm_type 漏洞利用;)
alert udp any any -> $HOME_NET 139 (msg:"NETBIOS Microsoft Windows NETAPI堆栈溢出入站-MS08-067（9）";content:"|20 00|";content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|";content:"|00 2E 00 2E 00 2F 00 2E 00 2E 00 2F|";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008698;classtype:attempted-admin;sid:2008698;rev:5;metadata:alarm_type 漏洞利用;)
alert udp any any -> $HOME_NET 139 (msg:"NETBIOS Microsoft Windows NETAPI堆栈溢出入站-MS08-067（10）";content:"|20 00|";content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|";content:"|00 2E 00 2E 00 5C 00 2E 00 2E 00 5C|";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008699;classtype:attempted-admin;sid:2008699;rev:5;metadata:alarm_type 漏洞利用;)
alert udp any any -> $HOME_NET 139 (msg:"NETBIOS Microsoft Windows NETAPI堆栈溢出入站-MS08-067-已知利用实例";content:"|00 2e 00 2e 00 2f 00 2e 00 2e 00 2f 00 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 87|";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008700;classtype:attempted-admin;sid:2008700;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp any any -> $HOME_NET 445 (msg:"NETBIOS Microsoft Windows NETAPI堆栈溢出入站-MS08-067（11）";flow:established,to_server;content:"|0B|";offset:2;depth:1;content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008701;classtype:attempted-admin;sid:2008701;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp any any -> $HOME_NET 445 (msg:"NETBIOS Microsoft Windows NETAPI堆栈溢出入站-MS08-067（12）";flow:established,to_server;content:"|1F 00|";content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|";content:"|5C|..|5C|";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008702;classtype:attempted-admin;sid:2008702;rev:6;metadata:alarm_type 漏洞利用;)
alert tcp any any -> $HOME_NET 445 (msg:"NETBIOS Microsoft Windows NETAPI堆栈溢出入站-MS08-067（13）";flow:established,to_server;content:"|1F 00|";content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|";content:"/../";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008703;classtype:attempted-admin;sid:2008703;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp any any -> $HOME_NET 445 (msg:"NETBIOS Microsoft Windows NETAPI堆栈溢出入站-MS08-067（14）";flow:established,to_server;content:"|1F 00|";content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|";content:"|00 2E 00 2E 00 2F 00 2E 00 2E 00 2F|";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008704;classtype:attempted-admin;sid:2008704;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp any any -> $HOME_NET 445 (msg:"NETBIOS Microsoft Windows NETAPI堆栈溢出入站-MS08-067（15）";flow:established,to_server;content:"|1F 00|";content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|";content:"|00 2E 00 2E 00 5C 00 2E 00 2E 00 5C|";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008705;classtype:attempted-admin;sid:2008705;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp any any -> $HOME_NET 139 (msg:"NETBIOS Microsoft Windows NETAPI堆栈溢出入站-MS08-067（16）";flow:established,to_server;content:"|0B|";offset:2;depth:1;content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008706;classtype:attempted-admin;sid:2008706;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp any any -> $HOME_NET 139 (msg:"NETBIOS Microsoft Windows NETAPI堆栈溢出入站-MS08-067（17）";flow:established,to_server;content:"|1F 00|";content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|";content:"..|5C|..|5C|";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008707;classtype:attempted-admin;sid:2008707;rev:6;metadata:alarm_type 漏洞利用;)
alert tcp any any -> $HOME_NET 139 (msg:"NETBIOS Microsoft Windows NETAPI堆栈溢出入站-MS08-067（18）";flow:established,to_server;content:"|1F 00|";content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|";content:"../../";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008708;classtype:attempted-admin;sid:2008708;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp any any -> $HOME_NET 139 (msg:"NETBIOS Microsoft Windows NETAPI堆栈溢出入站-MS08-067（19）";flow:established,to_server;content:"|1F 00|";content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|";content:"|00 2E 00 2E 00 2F 00 2E 00 2E 00 2F|";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008709;classtype:attempted-admin;sid:2008709;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp any any -> $HOME_NET 139 (msg:"NETBIOS Microsoft Windows NETAPI堆栈溢出入站-MS08-067（20）";flow:established,to_server;content:"|1F 00|";content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|";content:"|00 2E 00 2E 00 5C 00 2E 00 2E 00 5C|";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008710;classtype:attempted-admin;sid:2008710;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp any any -> $HOME_NET 445 (msg:"NETBIOS Microsoft Windows NETAPI堆栈溢出入站-MS08-067（22）";flow:established,to_server;content:"|20 00|";content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|";content:"|5C|..|5C|";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008712;classtype:attempted-admin;sid:2008712;rev:6;metadata:alarm_type 漏洞利用;)
alert tcp any any -> $HOME_NET 445 (msg:"NETBIOS Microsoft Windows NETAPI堆栈溢出入站-MS08-067（23）";flow:established,to_server;content:"|20 00|";content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|";content:"/../";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008713;classtype:attempted-admin;sid:2008713;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp any any -> $HOME_NET 445 (msg:"NETBIOS Microsoft Windows NETAPI堆栈溢出入站-MS08-067（24）";flow:established,to_server;content:"|20 00|";content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|";content:"|00 2E 00 2E 00 2F 00 2E 00 2E 00 2F|";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008714;classtype:attempted-admin;sid:2008714;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp any any -> $HOME_NET 445 (msg:"NETBIOS Microsoft Windows NETAPI堆栈溢出入站-MS08-067（25）";flow:established,to_server;content:"|20 00|";content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|";content:"|00 2E 00 2E 00 5C 00 2E 00 2E 00 5C|";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008715;classtype:attempted-admin;sid:2008715;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp any any -> $HOME_NET 139 (msg:"NETBIOS Microsoft Windows NETAPI堆栈溢出入站-MS08-067（27）";flow:established,to_server;content:"|20 00|";content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|";content:"..|5C|..|5C|";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008717;classtype:attempted-admin;sid:2008717;rev:6;metadata:alarm_type 漏洞利用;)
alert tcp any any -> $HOME_NET 139 (msg:"NETBIOS Microsoft Windows NETAPI堆栈溢出入站-MS08-067（28）";flow:established,to_server;content:"|20 00|";content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|";content:"../../";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008718;classtype:attempted-admin;sid:2008718;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp any any -> $HOME_NET 139 (msg:"NETBIOS Microsoft Windows NETAPI堆栈溢出入站-MS08-067（29）";flow:established,to_server;content:"|20 00|";content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|";content:"|00 2E 00 2E 00 2F 00 2E 00 2E 00 2F|";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008719;classtype:attempted-admin;sid:2008719;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp any any -> $HOME_NET 139 (msg:"NETBIOS Microsoft Windows NETAPI堆栈溢出入站-MS08-067（30）";flow:established,to_server;content:"|20 00|";content:"|C8 4F 32 4B 70 16 D3 01 12 78 5A 47 BF 6E E1 88|";content:"|00 2E 00 2E 00 5C 00 2E 00 2E 00 5C|";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008720;classtype:attempted-admin;sid:2008720;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp any any -> $HOME_NET 445 (msg:"NETBIOS Microsoft Windows NETAPI堆栈溢出入站-MS08-067-已知利用实例（2）";flow:established,to_server;content:"|00 2e 00 2e 00 2f 00 2e 00 2e 00 2f 00 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 87|";reference:url,www.microsoft.com/technet/security/Bulletin/MS08-067.mspx;reference:cve,2008-4250;reference:url,www.kb.cert.org/vuls/id/827267;reference:url,doc.emergingthreats.net/bin/view/Main/2008721;classtype:attempted-admin;sid:2008721;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET 445 -> $HOME_NET any (msg:"NETBIOS Microsoft Windows SMB客户端竞争条件远程执行代码";flow:to_client,established;content:"|ff 53 4d 42 72|";offset:4;depth:5;content:"|00 00 00 00|";distance:0;within:4;byte_test:4,<,4356,30,relative,little;reference:url,www.exploit-db.com/exploits/12258/;reference:cve,2010-0017;reference:bid,38100;reference:url,www.microsoft.com/technet/security/Bulletin/MS10-006.mspx;classtype:attempted-user;sid:2012084;rev:2;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB Trans2 Query_Fs_Attribute_Info SrvSmbQueryFs信息池缓冲区溢出";flow:to_server,established;content:"|ff 53 4d 42 32|";offset:4;depth:5;content:"|00 00 00 00|";distance:0;within:4;content:"|00 00|";distance:30;within:2;content:"|00 03 00|";distance:19;within:3;reference:url,www.exploit-db.com/exploits/14607/;reference:url,seclists.org/fulldisclosure/2010/Aug/122;reference:cve,2010-2550;reference:bid,42224;reference:url,www.microsoft.com/technet/security/Bulletin/MS10-054.mspx;classtype:attempted-user;sid:2012094;rev:2;metadata:alarm_type 漏洞利用;)
alert udp $EXTERNAL_NET any -> $HOME_NET [137,138,139,445] (msg:"NETBIOS Microsoft Windows Server 2003 Active Directory预身份验证浏览器选择堆溢出尝试";content:"|42 4F 00|";content:"BROWSER";nocase;distance:0;content:"|08 09 A8 0F 01 20|";fast_pattern;distance:0;isdataat:65,relative;content:!"|0A|";within:65;reference:url,tools.cisco.com/security/center/viewAlert.x?alertId=22457;reference:bid,46360;classtype:attempted-admin;sid:2012317;rev:2;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS InitiateSystemShutdown Unicode尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.winreg;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 18|";within:2;distance:19;classtype:protocol-command-decode;sid:2102480;rev:10;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS InitiateSystemShutdown Unicode小端尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.winreg;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|18 00|";within:2;distance:19;classtype:protocol-command-decode;sid:2102481;rev:10;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS InitiateSystemShutdown尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.winreg;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 18|";within:2;distance:19;classtype:protocol-command-decode;sid:2102482;rev:10;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS InitiateSystemShutdown小端尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.winreg;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|18 00|";within:2;distance:19;classtype:protocol-command-decode;sid:2102483;rev:9;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS Winreg Unicode绑定尝试";flow:established,to_server;flowbits:isset,smb.tree.create.winreg;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;content:"|05|";distance:4;within:1;content:"|0B|";within:1;distance:1;content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|";within:16;distance:29;flowbits:set,smb.tree.bind.winreg;classtype:protocol-command-decode;sid:2102479;rev:9;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS Winreg绑定尝试";flow:established,to_server;flowbits:isset,smb.tree.create.winreg;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;content:"|05|";distance:4;within:1;content:"|0B|";within:1;distance:1;content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|";within:16;distance:29;flowbits:set,smb.tree.bind.winreg;classtype:protocol-command-decode;sid:2102478;rev:9;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS Winreg Unicode创建树尝试";flow:established,to_server;flowbits:isset,smb.tree.connect.ipc;content:"|00|";depth:1;content:"|FF|SMB|A2|";within:5;distance:3;byte_test:1,&,128,6,relative;content:"|5C 00|w|00|i|00|n|00|r|00|e|00|g|00 00 00|";within:16;distance:78;nocase;flowbits:set,smb.tree.create.winreg;classtype:protocol-command-decode;sid:2102477;rev:8;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS winreg创建树尝试";flow:established,to_server;flowbits:isset,smb.tree.connect.ipc;content:"|00|";depth:1;content:"|FF|SMB|A2|";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"|5C|winreg|00|";within:8;distance:78;nocase;flowbits:set,smb.tree.create.winreg;classtype:protocol-command-decode;sid:2102476;rev:8;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS C $ Unicode共享访问";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMBu";within:5;distance:3;byte_test:1,&,128,6,relative;byte_jump:2,34,little,relative;content:"C|00 24 00 00 00|";distance:2;nocase;content:!"I|00|P|00|C|00 24 00 00 00|";within:10;distance:-10;nocase;classtype:protocol-command-decode;sid:2102472;rev:11;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB ADMIN $ Unicode共享访问";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMBu";within:5;distance:3;byte_test:1,&,128,6,relative;byte_jump:2,34,little,relative;content:"A|00|D|00|M|00|I|00|N|00 24 00 00 00|";distance:2;nocase;classtype:protocol-command-decode;sid:2102473;rev:9;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB C $ Unicode共享访问";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMBu";within:5;distance:3;byte_test:1,&,128,6,relative;byte_jump:2,34,little,relative;content:"C|00 24 00 00 00|";distance:2;nocase;content:!"I|00|P|00|C|00 24 00 00 00|";within:10;distance:-10;nocase;classtype:protocol-command-decode;sid:2102470;rev:12;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB D $ Unicode共享访问";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMBu";within:5;distance:3;byte_test:1,&,128,6,relative;byte_jump:2,34,little,relative;content:"D|00 24 00 00 00|";distance:2;nocase;classtype:protocol-command-decode;sid:2102467;rev:9;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS ADMIN $共享访问";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMBu";within:5;distance:3;byte_test:1,!&,128,6,relative;byte_jump:2,34,little,relative;content:"ADMIN|24 00|";distance:2;nocase;classtype:protocol-command-decode;sid:2102474;rev:9;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS ADMIN $ Unicode共享访问";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMBu";within:5;distance:3;byte_test:1,&,128,6,relative;byte_jump:2,34,little,relative;content:"A|00|D|00|M|00|I|00|N|00 24 00 00 00|";distance:2;nocase;classtype:protocol-command-decode;sid:2102475;rev:9;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS C $共享访问";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMBu";within:5;distance:3;byte_test:1,!&,128,6,relative;byte_jump:2,34,little,relative;content:"C|24 00|";distance:2;nocase;content:!"IPC|24 00|";within:5;distance:-5;nocase;classtype:protocol-command-decode;sid:2102471;rev:12;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB CoGetInstanceFromFile尝试";flow:established,to_server;flowbits:isset,dce.isystemactivator.bind;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 04|";within:2;distance:19;content:"|5C 5C|";byte_test:4,>,256,6;classtype:protocol-command-decode;sid:2103425;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB CoGetInstanceFromFile小端尝试";flow:established,to_server;flowbits:isset,dce.isystemactivator.bind;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|04 00|";within:2;distance:19;content:"|5C 5C|";byte_test:4,>,256,6,little;classtype:protocol-command-decode;sid:2103426;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB CoGetInstanceFromFile小字节序溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.msqueue;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|01 00|";within:2;distance:19;byte_test:4,>,128,20,relative;reference:cve,2003-0995;reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html;reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx;classtype:attempted-admin;sid:2103177;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB CoGetInstanceFromFile溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.msqueue;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 01|";within:2;distance:19;byte_test:4,>,128,20,relative;reference:cve,2003-0995;reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html;reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx;classtype:attempted-admin;sid:2103176;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB CoGetInstanceFromFile Unicode尝试";flow:established,to_server;flowbits:isset,dce.isystemactivator.bind;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 04|";within:2;distance:19;content:"|5C 00 5C 00|";byte_test:4,>,256,8;classtype:protocol-command-decode;sid:2103427;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB CoGetInstanceFromFile Unicode小端尝试";flow:established,to_server;flowbits:isset,dce.isystemactivator.bind;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|04 00|";within:2;distance:19;content:"|5C 00 5C 00|";byte_test:4,>,256,8,little;classtype:protocol-command-decode;sid:2103428;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB CoGetInstanceFromFile Unicode小字节序溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.msqueue;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|01 00|";within:2;distance:19;byte_test:4,>,256,20,relative;reference:cve,2003-0995;reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html;reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx;classtype:attempted-admin;sid:2103179;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB CoGetInstanceFromFile Unicode溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.msqueue;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 01|";within:2;distance:19;byte_test:4,>,256,20,relative;reference:cve,2003-0995;reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html;reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx;classtype:attempted-admin;sid:2103178;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB IActivation绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|B8|J|9F|M|1C|}|CF 11 86 1E 00| |AF|n|7C|W";within:16;distance:29;flowbits:set,dce.iactivation.bind;flowbits:noalert;classtype:protocol-command-decode;sid:2103377;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB IActivation小端绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|B8|J|9F|M|1C|}|CF 11 86 1E 00| |AF|n|7C|W";within:16;distance:29;flowbits:set,dce.iactivation.bind;flowbits:noalert;classtype:protocol-command-decode;sid:2103378;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB IActivation Unicode绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|B8|J|9F|M|1C|}|CF 11 86 1E 00| |AF|n|7C|W";within:16;distance:29;flowbits:set,dce.iactivation.bind;flowbits:noalert;classtype:protocol-command-decode;sid:2103379;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB IActivation Unicode小尾数绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|B8|J|9F|M|1C|}|CF 11 86 1E 00| |AF|n|7C|W";within:16;distance:29;flowbits:set,dce.iactivation.bind;flowbits:noalert;classtype:protocol-command-decode;sid:2103380;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB ISystemActivator绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|A0 01 00 00 00 00 00 00 C0 00 00 00 00 00 00|F";within:16;distance:29;flowbits:set,dce.isystemactivator.bind;flowbits:noalert;classtype:protocol-command-decode;sid:2103393;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB ISystemActivator Unicode小尾数绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|A0 01 00 00 00 00 00 00 C0 00 00 00 00 00 00|F";within:16;distance:29;flowbits:set,dce.isystemactivator.bind;flowbits:noalert;classtype:protocol-command-decode;sid:2103396;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB InitiateSystemShutdown尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.winreg;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 18|";within:2;distance:19;classtype:protocol-command-decode;sid:2102942;rev:6;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB InitiateSystemShutdown小端尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.winreg;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|18 00|";within:2;distance:19;classtype:protocol-command-decode;sid:2102943;rev:6;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB InitiateSystemShutdown Unicode尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.winreg;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 18|";within:2;distance:19;classtype:protocol-command-decode;sid:2102944;rev:6;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB InitiateSystemShutdown Unicode小端尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.winreg;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|18 00|";within:2;distance:19;classtype:protocol-command-decode;sid:2102945;rev:6;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB IrotIsRunning尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.irot;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 02|";within:2;distance:19;byte_jump:4,8,relative,little,align;byte_test:4,>,1024,0,little;reference:bugtraq,6005;reference:cve,2002-1561;reference:url,www.microsoft.com/technet/security/bulletin/MS03-010.mspx;classtype:protocol-command-decode;sid:2103256;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB IrotIsRunning小字节序尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.irot;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|02 00|";within:2;distance:19;byte_jump:4,8,relative,little,align;byte_test:4,>,1024,0,little;reference:bugtraq,6005;reference:cve,2002-1561;reference:url,www.microsoft.com/technet/security/bulletin/MS03-010.mspx;classtype:protocol-command-decode;sid:2103257;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB IrotIsRunning Unicode尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.irot;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 02|";within:2;distance:19;byte_jump:4,8,relative,little,align;byte_test:4,>,1024,0,little;reference:bugtraq,6005;reference:cve,2002-1561;reference:url,www.microsoft.com/technet/security/bulletin/MS03-010.mspx;classtype:protocol-command-decode;sid:2103258;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB IrotIsRunning Unicode小端尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.irot;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|02 00|";within:2;distance:19;byte_jump:4,8,relative,little,align;byte_test:4,>,1024,0,little;reference:bugtraq,6005;reference:cve,2002-1561;reference:url,www.microsoft.com/technet/security/bulletin/MS03-010.mspx;classtype:protocol-command-decode;sid:2103259;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB NDdeSetTrustedShareW小字节序溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.nddeapi;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|0C 00|";within:2;distance:19;isdataat:256,relative;content:!"|00|";within:256;distance:12;reference:bugtraq,11372;reference:cve,2004-0206;classtype:attempted-admin;sid:2102946;rev:7;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB NDdeSetTrustedShareW溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.nddeapi;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 0C|";within:2;distance:19;isdataat:256,relative;content:!"|00|";within:256;distance:12;reference:bugtraq,11372;reference:cve,2004-0206;classtype:attempted-admin;sid:2102936;rev:6;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB NDdeSetTrustedShareW Unicode小字节序溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.nddeapi;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|0C 00|";within:2;distance:19;isdataat:512,relative;content:!"|00 00|";within:512;distance:12;reference:bugtraq,11372;reference:cve,2004-0206;classtype:attempted-admin;sid:2102947;rev:6;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB NDdeSetTrustedShareW Unicode溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.nddeapi;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 0C|";within:2;distance:19;isdataat:512,relative;content:!"|00 00|";within:512;distance:12;reference:bugtraq,11372;reference:cve,2004-0206;classtype:attempted-admin;sid:2102937;rev:6;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB NT Trans NT创建超大的安全描述符尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB|A0|";within:5;distance:3;byte_test:1,!&,128,6,relative;pcre:"/^.{27}/R";content:"|01 00|";within:2;distance:37;byte_jump:4,-15,little,relative,from_beginning;pcre:"/^.{4}/R";byte_test:4,>,1024,36,relative,little;reference:cve,2004-1154;classtype:protocol-command-decode;sid:2103018;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB NT Trans NT创建Unicode超大安全描述符尝试";flow:established,to_server;content:"|00|";depth:1;content:"|00|";depth:1;content:"|FF|SMB|A0|";within:5;distance:3;byte_test:1,&,128,6,relative;pcre:"/^.{27}/R";content:"|01 00|";within:2;distance:37;byte_jump:4,-15,little,relative,from_beginning;pcre:"/^.{4}/R";byte_test:4,>,1024,36,relative,little;reference:cve,2004-1154;classtype:protocol-command-decode;sid:2103020;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB OpenKey小字节序溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.winreg;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|0F 00|";within:2;distance:19;byte_test:2,>,1024,20,relative,little;reference:bugtraq,1331;reference:cve,2000-0377;classtype:attempted-admin;sid:2103219;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB OpenKey溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.winreg;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 0F|";within:2;distance:19;byte_test:2,>,1024,20,relative;reference:bugtraq,1331;reference:cve,2000-0377;reference:url,www.microsoft.com/technet/security/bulletin/MS00-040.mspx;classtype:attempted-admin;sid:2103218;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB OpenKey Unicode小字节序溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.winreg;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|0F 00|";within:2;distance:19;byte_test:2,>,2048,20,relative,little;reference:bugtraq,1331;reference:cve,2000-0377;classtype:attempted-admin;sid:2103221;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB OpenKey Unicode溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.winreg;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 0F|";within:2;distance:19;byte_test:2,>,2048,20,relative;reference:bugtraq,1331;reference:cve,2000-0377;classtype:attempted-admin;sid:2103220;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB RemoteActivation尝试";flow:established,to_server;flowbits:isset,dce.iactivation.bind;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 00|";within:2;distance:19;content:"|5C 5C|";byte_test:4,>,256,6;classtype:protocol-command-decode;sid:2103409;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB RemoteActivation小端尝试";flow:established,to_server;flowbits:isset,dce.iactivation.bind;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 00|";within:2;distance:19;content:"|5C 5C|";byte_test:4,>,256,6,little;classtype:protocol-command-decode;sid:2103410;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB RemoteActivation Unicode尝试";flow:established,to_server;flowbits:isset,dce.iactivation.bind;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 00|";within:2;distance:19;content:"|5C 00 5C 00|";byte_test:4,>,256,8;classtype:protocol-command-decode;sid:2103411;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB RemoteActivation Unicode小端尝试";flow:established,to_server;flowbits:isset,dce.iactivation.bind;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 00|";within:2;distance:19;content:"|5C 00 5C 00|";byte_test:4,>,256,8,little;classtype:protocol-command-decode;sid:2103412;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB irot绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?";within:16;distance:29;flowbits:set,smb.tree.bind.irot;flowbits:noalert;classtype:protocol-command-decode;sid:2103240;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB irot小字节序绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?";within:16;distance:29;flowbits:set,smb.tree.bind.irot;flowbits:noalert;classtype:protocol-command-decode;sid:2103241;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB llsrconnect小字节序溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.llsrpc;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 00|";within:2;distance:19;byte_test:4,>,52,0,relative;reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx;classtype:attempted-admin;sid:2103115;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB llsrconnect溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.llsrpc;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 00|";within:2;distance:19;byte_test:4,>,52,0,relative;reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx;classtype:attempted-admin;sid:2103114;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB llsrconnect unicode小尾数溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.llsrpc;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 00|";within:2;distance:19;byte_test:4,>,104,0,relative;reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx;classtype:attempted-admin;sid:2103117;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB llsrconnect Unicode溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.llsrpc;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 00|";within:2;distance:19;byte_test:4,>,104,0,relative;reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx;classtype:attempted-admin;sid:2103116;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB llsrpc绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m";within:16;distance:29;flowbits:set,smb.tree.bind.llsrpc;classtype:protocol-command-decode;sid:2103098;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB llsrpc创建树尝试";flow:established,to_server;flowbits:isset,smb.tree.connect.ipc;content:"|00|";depth:1;content:"|FF|SMB|A2|";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"|5C|llsrpc|00|";within:8;distance:78;nocase;classtype:protocol-command-decode;sid:2103090;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB llsrpc小端绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m";within:16;distance:29;flowbits:set,smb.tree.bind.llsrpc;classtype:protocol-command-decode;sid:2103099;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB msqueue绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|B0 01|R|97 CA|Y|D0 11 A8 D5 00 A0 C9 0D 80|Q";within:16;distance:29;flowbits:set,smb.tree.bind.msqueue;flowbits:noalert;reference:cve,2003-0995;reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html;reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx;classtype:protocol-command-decode;sid:2103160;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB msqueue小尾数绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|B0 01|R|97 CA|Y|D0 11 A8 D5 00 A0 C9 0D 80|Q";within:16;distance:29;flowbits:set,smb.tree.bind.msqueue;flowbits:noalert;reference:cve,2003-0995;reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html;reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx;classtype:protocol-command-decode;sid:2103161;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB nddeapi绑定尝试";flow:established,to_server;flowbits:isset,smb.tree.create.nddeapi;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;content:"|05|";distance:4;within:1;content:"|0B|";within:1;distance:1;content:" 2_/&|C1|v|10 B5|I|07|M|07 86 19 DA|";within:16;distance:29;flowbits:set,smb.tree.bind.nddeapi;reference:bugtraq,11372;reference:cve,2004-0206;classtype:protocol-command-decode;sid:2102932;rev:6;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB msqueue Unicode绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|B0 01|R|97 CA|Y|D0 11 A8 D5 00 A0 C9 0D 80|Q";within:16;distance:29;flowbits:set,smb.tree.bind.msqueue;flowbits:noalert;reference:cve,2003-0995;reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html;reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx;classtype:protocol-command-decode;sid:2103162;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB msqueue Unicode小端绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|B0 01|R|97 CA|Y|D0 11 A8 D5 00 A0 C9 0D 80|Q";within:16;distance:29;flowbits:set,smb.tree.bind.msqueue;flowbits:noalert;reference:cve,2003-0995;reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html;reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx;classtype:protocol-command-decode;sid:2103163;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB nddeapi创建树尝试";flow:established,to_server;flowbits:isset,smb.tree.connect.ipc;content:"|00|";depth:1;content:"|FF|SMB|A2|";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"|5C|nddeapi|00|";within:9;distance:78;nocase;flowbits:set,smb.tree.create.nddeapi;reference:bugtraq,11372;reference:cve,2004-0206;classtype:protocol-command-decode;sid:2102928;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB nddeapi Unicode绑定尝试";flow:established,to_server;flowbits:isset,smb.tree.create.nddeapi;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;content:"|05|";distance:4;within:1;content:"|0B|";within:1;distance:1;content:" 2_/&|C1|v|10 B5|I|07|M|07 86 19 DA|";within:16;distance:29;flowbits:set,smb.tree.bind.nddeapi;reference:bugtraq,11372;reference:cve,2004-0206;classtype:protocol-command-decode;sid:2102933;rev:6;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB nddeapi Unicode创建树尝试";flow:established,to_server;flowbits:isset,smb.tree.connect.ipc;content:"|00|";depth:1;content:"|FF|SMB|A2|";within:5;distance:3;byte_test:1,&,128,6,relative;content:"|5C 00|n|00|d|00|d|00|e|00|a|00|p|00|i|00 00 00|";within:18;distance:78;nocase;flowbits:set,smb.tree.create.nddeapi;reference:bugtraq,11372;reference:cve,2004-0206;classtype:protocol-command-decode;sid:2102929;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB Winreg绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|";within:16;distance:29;flowbits:set,smb.tree.bind.winreg;flowbits:noalert;classtype:protocol-command-decode;sid:2103202;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB Winreg绑定尝试";flow:established,to_server;flowbits:isset,smb.tree.create.winreg;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;content:"|05|";distance:4;within:1;content:"|0B|";within:1;distance:1;content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|";within:16;distance:29;flowbits:set,smb.tree.bind.winreg;classtype:protocol-command-decode;sid:2102940;rev:6;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB Winreg创建树尝试";flow:established,to_server;flowbits:isset,smb.tree.connect.ipc;content:"|00|";depth:1;content:"|FF|SMB|A2|";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"|5C|winreg|00|";within:8;distance:78;nocase;flowbits:set,smb.tree.create.winreg;classtype:protocol-command-decode;sid:2102174;rev:9;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB Winreg小尾数绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|";within:16;distance:29;flowbits:set,smb.tree.bind.winreg;flowbits:noalert;classtype:protocol-command-decode;sid:2103203;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB Winreg Unicode绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|";within:16;distance:29;flowbits:set,smb.tree.bind.winreg;flowbits:noalert;classtype:protocol-command-decode;sid:2103204;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB Winreg Unicode绑定尝试";flow:established,to_server;flowbits:isset,smb.tree.create.winreg;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;content:"|05|";distance:4;within:1;content:"|0B|";within:1;distance:1;content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|";within:16;distance:29;flowbits:set,smb.tree.bind.winreg;classtype:protocol-command-decode;sid:2102941;rev:6;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB Winreg Unicode创建树尝试";flow:established,to_server;flowbits:isset,smb.tree.connect.ipc;content:"|00|";depth:1;content:"|FF|SMB|A2|";within:5;distance:3;byte_test:1,&,128,6,relative;content:"|5C 00|w|00|i|00|n|00|r|00|e|00|g|00 00 00|";within:16;distance:78;nocase;flowbits:set,smb.tree.create.winreg;classtype:protocol-command-decode;sid:2102175;rev:10;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB Winreg Unicode小端绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|";within:16;distance:29;flowbits:set,smb.tree.bind.winreg;flowbits:noalert;classtype:protocol-command-decode;sid:2103205;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS CoGetInstanceFromFile尝试";flow:established,to_server;flowbits:isset,dce.isystemactivator.bind;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 04|";within:2;distance:19;content:"|5C 5C|";byte_test:4,>,256,6;classtype:protocol-command-decode;sid:2103433;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS CoGetInstanceFromFile小端尝试";flow:established,to_server;flowbits:isset,dce.isystemactivator.bind;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|04 00|";within:2;distance:19;content:"|5C 5C|";byte_test:4,>,256,6,little;classtype:protocol-command-decode;sid:2103434;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS CoGetInstanceFromFile小字节序溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.msqueue;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|01 00|";within:2;distance:19;byte_test:4,>,128,20,relative;reference:cve,2003-0995;reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html;reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx;classtype:attempted-admin;sid:2103185;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS CoGetInstanceFromFile溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.msqueue;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 01|";within:2;distance:19;byte_test:4,>,128,20,relative;reference:cve,2003-0995;reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html;reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx;classtype:attempted-admin;sid:2103184;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS CoGetInstanceFromFile Unicode尝试";flow:established,to_server;flowbits:isset,dce.isystemactivator.bind;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 04|";within:2;distance:19;content:"|5C 00 5C 00|";byte_test:4,>,256,8;classtype:protocol-command-decode;sid:2103435;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS CoGetInstanceFromFile Unicode小端尝试";flow:established,to_server;flowbits:isset,dce.isystemactivator.bind;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|04 00|";within:2;distance:19;content:"|5C 00 5C 00|";byte_test:4,>,256,8,little;classtype:protocol-command-decode;sid:2103436;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS CoGetInstanceFromFile Unicode小字节序溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.msqueue;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|01 00|";within:2;distance:19;byte_test:4,>,256,20,relative;reference:cve,2003-0995;reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html;reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx;classtype:attempted-admin;sid:2103187;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS CoGetInstanceFromFile Unicode溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.msqueue;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 01|";within:2;distance:19;byte_test:4,>,256,20,relative;reference:cve,2003-0995;reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html;reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx;classtype:attempted-admin;sid:2103186;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS D $共享访问";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMBu";within:5;distance:3;byte_test:1,!&,128,6,relative;byte_jump:2,34,little,relative;content:"D|24 00|";distance:2;nocase;classtype:protocol-command-decode;sid:2102468;rev:9;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS D $ Unicode共享访问";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMBu";within:5;distance:3;byte_test:1,&,128,6,relative;byte_jump:2,34,little,relative;content:"D|00 24 00 00 00|";distance:2;nocase;classtype:protocol-command-decode;sid:2102469;rev:9;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS IActivation绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|B8|J|9F|M|1C|}|CF 11 86 1E 00| |AF|n|7C|W";within:16;distance:29;flowbits:set,dce.iactivation.bind;flowbits:noalert;classtype:protocol-command-decode;sid:2103385;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS IActivation小尾数绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|B8|J|9F|M|1C|}|CF 11 86 1E 00| |AF|n|7C|W";within:16;distance:29;flowbits:set,dce.iactivation.bind;flowbits:noalert;classtype:protocol-command-decode;sid:2103386;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS IActivation Unicode绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|B8|J|9F|M|1C|}|CF 11 86 1E 00| |AF|n|7C|W";within:16;distance:29;flowbits:set,dce.iactivation.bind;flowbits:noalert;classtype:protocol-command-decode;sid:2103387;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS IActivation Unicode小尾数绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|B8|J|9F|M|1C|}|CF 11 86 1E 00| |AF|n|7C|W";within:16;distance:29;flowbits:set,dce.iactivation.bind;flowbits:noalert;classtype:protocol-command-decode;sid:2103388;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS IPC $共享访问";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMBu";within:5;distance:3;byte_test:1,!&,128,6,relative;byte_jump:2,34,little,relative;content:"IPC|24 00|";distance:2;nocase;flowbits:set,smb.tree.connect.ipc;classtype:protocol-command-decode;sid:2102465;rev:9;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS IPC $ Unicode共享访问";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMBu";within:5;distance:3;byte_test:1,&,128,6,relative;byte_jump:2,34,little,relative;content:"I|00|P|00|C|00 24 00 00 00|";distance:2;nocase;flowbits:set,smb.tree.connect.ipc;classtype:protocol-command-decode;sid:2102466;rev:9;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS ISystemActivator绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|A0 01 00 00 00 00 00 00 C0 00 00 00 00 00 00|F";within:16;distance:29;flowbits:set,dce.isystemactivator.bind;flowbits:noalert;classtype:protocol-command-decode;sid:2103401;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS ISystemActivator小端绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|A0 01 00 00 00 00 00 00 C0 00 00 00 00 00 00|F";within:16;distance:29;flowbits:set,dce.isystemactivator.bind;flowbits:noalert;classtype:protocol-command-decode;sid:2103402;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS ISystemActivator Unicode绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|A0 01 00 00 00 00 00 00 C0 00 00 00 00 00 00|F";within:16;distance:29;flowbits:set,dce.isystemactivator.bind;flowbits:noalert;classtype:protocol-command-decode;sid:2103403;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS ISystemActivator Unicode小尾数绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|A0 01 00 00 00 00 00 00 C0 00 00 00 00 00 00|F";within:16;distance:29;flowbits:set,dce.isystemactivator.bind;flowbits:noalert;classtype:protocol-command-decode;sid:2103404;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS IrotIsRunning尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.irot;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 02|";within:2;distance:19;byte_jump:4,8,relative,little,align;byte_test:4,>,1024,0,little;reference:bugtraq,6005;reference:cve,2002-1561;reference:url,www.microsoft.com/technet/security/bulletin/MS03-010.mspx;classtype:protocol-command-decode;sid:2103264;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS IrotIsRunning小字节序尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.irot;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|02 00|";within:2;distance:19;byte_jump:4,8,relative,little,align;byte_test:4,>,1024,0,little;reference:bugtraq,6005;reference:cve,2002-1561;reference:url,www.microsoft.com/technet/security/bulletin/MS03-010.mspx;classtype:protocol-command-decode;sid:2103265;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS IrotIsRunning Unicode尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.irot;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 02|";within:2;distance:19;byte_jump:4,8,relative,little,align;byte_test:4,>,1024,0,little;reference:bugtraq,6005;reference:cve,2002-1561;reference:url,www.microsoft.com/technet/security/bulletin/MS03-010.mspx;classtype:protocol-command-decode;sid:2103266;rev:6;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS IrotIsRunning Unicode小端尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.irot;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|02 00|";within:2;distance:19;byte_jump:4,8,relative,little,align;byte_test:4,>,1024,0,little;reference:bugtraq,6005;reference:cve,2002-1561;reference:url,www.microsoft.com/technet/security/bulletin/MS03-010.mspx;classtype:protocol-command-decode;sid:2103267;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS NDdeSetTrustedShareW小字节序溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.nddeapi;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|0C 00|";within:2;distance:19;isdataat:256,relative;content:!"|00|";within:256;distance:12;reference:bugtraq,11372;reference:cve,2004-0206;classtype:attempted-admin;sid:2102948;rev:7;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS NDdeSetTrustedShareW Unicode溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.nddeapi;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 0C|";within:2;distance:19;isdataat:512,relative;content:!"|00 00|";within:512;distance:12;reference:bugtraq,11372;reference:cve,2004-0206;classtype:attempted-admin;sid:2102939;rev:7;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS NT Trans NT CREATE Unicode超大的安全描述符尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB|A0|";within:5;distance:3;byte_test:1,&,128,6,relative;pcre:"/^.{27}/R";content:"|01 00|";within:2;distance:37;byte_jump:4,-15,little,relative,from_beginning;pcre:"/^.{4}/R";byte_test:4,>,1024,36,relative,little;reference:cve,2004-1154;classtype:protocol-command-decode;sid:2103024;rev:3;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS OpenKey小字节序溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.winreg;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|0F 00|";within:2;distance:19;byte_test:2,>,1024,20,relative,little;reference:bugtraq,1331;reference:cve,2000-0377;classtype:attempted-admin;sid:2103227;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS OpenKey溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.winreg;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 0F|";within:2;distance:19;byte_test:2,>,1024,20,relative;reference:bugtraq,1331;reference:cve,2000-0377;classtype:attempted-admin;sid:2103226;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS OpenKey Unicode小字节序溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.winreg;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|0F 00|";within:2;distance:19;byte_test:2,>,2048,20,relative,little;reference:bugtraq,1331;reference:cve,2000-0377;classtype:attempted-admin;sid:2103229;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS OpenKey Unicode溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.winreg;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 0F|";within:2;distance:19;byte_test:2,>,2048,20,relative;reference:bugtraq,1331;reference:cve,2000-0377;classtype:attempted-admin;sid:2103228;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS RemoteActivation尝试";flow:established,to_server;flowbits:isset,dce.iactivation.bind;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 00|";within:2;distance:19;content:"|5C 5C|";byte_test:4,>,256,6;classtype:protocol-command-decode;sid:2103417;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS RemoteActivation小端尝试";flow:established,to_server;flowbits:isset,dce.iactivation.bind;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 00|";within:2;distance:19;content:"|5C 5C|";byte_test:4,>,256,6,little;classtype:protocol-command-decode;sid:2103418;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS RemoteActivation Unicode尝试";flow:established,to_server;flowbits:isset,dce.iactivation.bind;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 00|";within:2;distance:19;content:"|5C 00 5C 00|";byte_test:4,>,256,8;classtype:protocol-command-decode;sid:2103419;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS RemoteActivation Unicode小端尝试";flow:established,to_server;flowbits:isset,dce.iactivation.bind;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 00|";within:2;distance:19;content:"|5C 00 5C 00|";byte_test:4,>,256,8,little;classtype:protocol-command-decode;sid:2103420;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS irot绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?";within:16;distance:29;flowbits:set,smb.tree.bind.irot;flowbits:noalert;classtype:protocol-command-decode;sid:2103248;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS irot小字节序绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?";within:16;distance:29;flowbits:set,smb.tree.bind.irot;flowbits:noalert;classtype:protocol-command-decode;sid:2103249;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS irot Unicode绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?";within:16;distance:29;flowbits:set,smb.tree.bind.irot;flowbits:noalert;classtype:protocol-command-decode;sid:2103250;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS irot Unicode小尾数绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?";within:16;distance:29;flowbits:set,smb.tree.bind.irot;flowbits:noalert;classtype:protocol-command-decode;sid:2103251;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS llsrconnect小字节序溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.llsrpc;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 00|";within:2;distance:19;byte_test:4,>,52,0,relative;reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx;classtype:attempted-admin;sid:2103123;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS llsrconnect溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.llsrpc;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 00|";within:2;distance:19;byte_test:4,>,52,0,relative;reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx;classtype:attempted-admin;sid:2103122;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS llsrconnect unicode小尾数溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.llsrpc;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 00|";within:2;distance:19;byte_test:4,>,104,0,relative;reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx;classtype:attempted-admin;sid:2103125;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS llsrconnect Unicode溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.llsrpc;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 00|";within:2;distance:19;byte_test:4,>,104,0,relative;reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx;classtype:attempted-admin;sid:2103124;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS llsrpc绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m";within:16;distance:29;flowbits:set,smb.tree.bind.llsrpc;classtype:protocol-command-decode;sid:2103106;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS llsrpc小尾数绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m";within:16;distance:29;flowbits:set,smb.tree.bind.llsrpc;classtype:protocol-command-decode;sid:2103107;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS llsrpc Unicode绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m";within:16;distance:29;flowbits:set,smb.tree.bind.llsrpc;classtype:protocol-command-decode;sid:2103108;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS llsrpc Unicode小尾数绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m";within:16;distance:29;flowbits:set,smb.tree.bind.llsrpc;classtype:protocol-command-decode;sid:2103109;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS msqueue Unicode绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|B0 01|R|97 CA|Y|D0 11 A8 D5 00 A0 C9 0D 80|Q";within:16;distance:29;flowbits:set,smb.tree.bind.msqueue;flowbits:noalert;reference:cve,2003-0995;reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html;reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx;classtype:protocol-command-decode;sid:2103170;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS msqueue Unicode小尾数绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|B0 01|R|97 CA|Y|D0 11 A8 D5 00 A0 C9 0D 80|Q";within:16;distance:29;flowbits:set,smb.tree.bind.msqueue;flowbits:noalert;reference:cve,2003-0995;reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html;reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx;classtype:protocol-command-decode;sid:2103171;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS nddeapi绑定尝试";flow:established,to_server;flowbits:isset,smb.tree.create.nddeapi;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;content:"|05|";distance:4;within:1;content:"|0B|";within:1;distance:1;content:" 2_/&|C1|v|10 B5|I|07|M|07 86 19 DA|";within:16;distance:29;flowbits:set,smb.tree.bind.nddeapi;reference:bugtraq,11372;reference:cve,2004-0206;classtype:protocol-command-decode;sid:2102934;rev:6;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS nddeapi创建树尝试";flow:established,to_server;flowbits:isset,smb.tree.connect.ipc;content:"|00|";depth:1;content:"|FF|SMB|A2|";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"|5C|nddeapi|00|";within:9;distance:78;nocase;flowbits:set,smb.tree.create.nddeapi;reference:bugtraq,11372;reference:cve,2004-0206;classtype:protocol-command-decode;sid:2102930;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS nddeapi Unicode绑定尝试";flow:established,to_server;flowbits:isset,smb.tree.create.nddeapi;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;content:"|05|";distance:4;within:1;content:"|0B|";within:1;distance:1;content:" 2_/&|C1|v|10 B5|I|07|M|07 86 19 DA|";within:16;distance:29;flowbits:set,smb.tree.bind.nddeapi;reference:bugtraq,11372;reference:cve,2004-0206;classtype:protocol-command-decode;sid:2102935;rev:7;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS nddeapi Unicode创建树尝试";flow:established,to_server;flowbits:isset,smb.tree.connect.ipc;content:"|00|";depth:1;content:"|FF|SMB|A2|";within:5;distance:3;byte_test:1,&,128,6,relative;content:"|5C 00|n|00|d|00|d|00|e|00|a|00|p|00|i|00 00 00|";within:18;distance:78;nocase;flowbits:set,smb.tree.create.nddeapi;reference:bugtraq,11372;reference:cve,2004-0206;classtype:protocol-command-decode;sid:2102931;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS Winreg绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|";within:16;distance:29;flowbits:set,smb.tree.bind.winreg;flowbits:noalert;classtype:protocol-command-decode;sid:2103210;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS winreg小尾数绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|";within:16;distance:29;flowbits:set,smb.tree.bind.winreg;flowbits:noalert;classtype:protocol-command-decode;sid:2103211;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS Winreg Unicode绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|";within:16;distance:29;flowbits:set,smb.tree.bind.winreg;flowbits:noalert;classtype:protocol-command-decode;sid:2103212;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS Winreg Unicode小端绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|";within:16;distance:29;flowbits:set,smb.tree.bind.winreg;flowbits:noalert;classtype:protocol-command-decode;sid:2103213;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB ISystemActivator小端绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|A0 01 00 00 00 00 00 00 C0 00 00 00 00 00 00|F";within:16;distance:29;flowbits:set,dce.isystemactivator.bind;flowbits:noalert;classtype:protocol-command-decode;sid:2103394;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB ISystemActivator Unicode绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|A0 01 00 00 00 00 00 00 C0 00 00 00 00 00 00|F";within:16;distance:29;flowbits:set,dce.isystemactivator.bind;flowbits:noalert;classtype:protocol-command-decode;sid:2103395;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB irot Unicode绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?";within:16;distance:29;flowbits:set,smb.tree.bind.irot;flowbits:noalert;classtype:protocol-command-decode;sid:2103242;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB irot Unicode小尾数绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?";within:16;distance:29;flowbits:set,smb.tree.bind.irot;flowbits:noalert;classtype:protocol-command-decode;sid:2103243;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB llsrpc Unicode绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m";within:16;distance:29;flowbits:set,smb.tree.bind.llsrpc;classtype:protocol-command-decode;sid:2103100;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB llsrpc Unicode小尾数绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m";within:16;distance:29;flowbits:set,smb.tree.bind.llsrpc;classtype:protocol-command-decode;sid:2103101;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS NDdeSetTrustedShareW溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.nddeapi;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 0C|";within:2;distance:19;isdataat:256,relative;content:!"|00|";within:256;distance:12;reference:bugtraq,11372;reference:cve,2004-0206;classtype:attempted-admin;sid:2102938;rev:6;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS NDdeSetTrustedShareW Unicode小尾数溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.nddeapi;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|0C 00|";within:2;distance:19;isdataat:512,relative;content:!"|00 00|";within:512;distance:12;reference:bugtraq,11372;reference:cve,2004-0206;classtype:attempted-admin;sid:2102949;rev:7;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS msqueue绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|B0 01|R|97 CA|Y|D0 11 A8 D5 00 A0 C9 0D 80|Q";within:16;distance:29;flowbits:set,smb.tree.bind.msqueue;flowbits:noalert;reference:cve,2003-0995;reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html;reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx;classtype:protocol-command-decode;sid:2103168;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS msqueue小字节序绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB%";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|B0 01|R|97 CA|Y|D0 11 A8 D5 00 A0 C9 0D 80|Q";within:16;distance:29;flowbits:set,smb.tree.bind.msqueue;flowbits:noalert;reference:cve,2003-0995;reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html;reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx;classtype:protocol-command-decode;sid:2103169;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB IPC $ Unicode共享访问";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMBu";within:5;distance:3;byte_test:1,&,128,6,relative;byte_jump:2,34,little,relative;content:"I|00|P|00|C|00 24 00 00 00|";distance:2;nocase;flowbits:set,smb.tree.connect.ipc;classtype:protocol-command-decode;sid:2100538;rev:17;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB IPC $共享访问";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMBu";within:5;distance:3;byte_test:1,!&,128,6,relative;byte_jump:2,34,little,relative;content:"IPC|24 00|";distance:2;nocase;flowbits:set,smb.tree.connect.ipc;classtype:protocol-command-decode;sid:2100537;rev:17;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB D $共享访问";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMBu";within:5;distance:3;byte_test:1,!&,128,6,relative;byte_jump:2,34,little,relative;content:"D|24 00|";distance:2;nocase;classtype:protocol-command-decode;sid:2100536;rev:13;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB CD ...";flow:to_server,established;content:"|5C|...|00 00 00|";reference:arachnids,337;classtype:attempted-recon;sid:2100535;rev:7;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB CD ..";flow:to_server,established;content:"|5C|../|00 00 00|";reference:arachnids,338;classtype:attempted-recon;sid:2100534;rev:7;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB C $共享访问";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMBu";within:5;distance:3;byte_test:1,!&,128,6,relative;byte_jump:2,34,little,relative;content:"C|24 00|";distance:2;nocase;content:!"IPC|24 00|";within:5;distance:-5;nocase;classtype:protocol-command-decode;sid:2100533;rev:17;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB ADMIN $共享访问";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMBu";within:5;distance:3;byte_test:1,!&,128,6,relative;byte_jump:2,34,little,relative;content:"ADMIN|24 00|";distance:2;nocase;classtype:protocol-command-decode;sid:2100532;rev:14;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS NT NULL会话";flow:to_server,established;content:"|00 00 00 00|W|00|i|00|n|00|d|00|o|00|w|00|s|00| |00|N|00|T|00| |00|1|00|3|00|8|00|1";reference:arachnids,204;reference:bugtraq,1163;reference:cve,2000-0347;classtype:attempted-recon;sid:2100530;rev:11;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS DOS RFPoison";flow:to_server,established;content:"|5C 00 5C 00|*|00|S|00|M|00|B|00|S|00|E|00|R|00|V|00|E|00|R|00 00 00 00 00 01 00 00 00 01 00 00 00 00 00 00 00 FF FF FF FF 00 00 00 00|";reference:arachnids,454;classtype:attempted-dos;sid:2100529;rev:8;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS会话设置NTMLSSP asn1溢出尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMBs";within:5;distance:3;byte_test:1,!&,128,6,relative;byte_test:4,&,2147483648,48,relative,little;content:!"NTLMSSP";within:7;distance:54;asn1:double_overflow, bitstring_overflow, relative_offset 54, oversize_length 2048;reference:bugtraq,9633;reference:bugtraq,9635;reference:cve,2003-0818;reference:nessus,12052;reference:nessus,12065;reference:url,www.microsoft.com/technet/security/bulletin/MS04-007.mspx;classtype:protocol-command-decode;sid:2102383;rev:21;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS会话设置NTMLSSP Unicode ASN1溢出尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMBs";within:5;distance:3;byte_test:1,&,128,6,relative;byte_test:4,&,2147483648,48,relative,little;content:!"NTLMSSP";within:7;distance:54;asn1:double_overflow, bitstring_overflow, relative_offset 54, oversize_length 2048;reference:bugtraq,9633;reference:bugtraq,9635;reference:cve,2003-0818;reference:nessus,12052;reference:nessus,12065;reference:url,www.microsoft.com/technet/security/bulletin/MS04-007.mspx;classtype:protocol-command-decode;sid:2103003;rev:7;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS CoGetInstanceFromFile和x尝试";flow:established,to_server;flowbits:isset,dce.isystemactivator.bind;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 04|";within:2;distance:19;content:"|5C 5C|";byte_test:4,>,256,6;classtype:protocol-command-decode;sid:2103437;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB CoGetInstanceFromFile和x尝试";flow:established,to_server;flowbits:isset,dce.isystemactivator.bind;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 04|";within:2;distance:19;content:"|5C 5C|";byte_test:4,>,256,6;classtype:protocol-command-decode;sid:2103429;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"NETBIOS DCERPC CoGetInstanceFromFile小端溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.msqueue;content:"|05|";depth:1;byte_test:1,&,16,3,relative;content:"|00|";offset:1;depth:1;content:"|01 00|";distance:19;within:2;byte_test:4,>,128,20,relative,little;reference:cve,2003-0995;reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html;reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx;classtype:attempted-admin;sid:2103158;rev:6;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"NETBIOS DCERPC CoGetInstanceFromFile溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.msqueue;content:"|05|";byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|01 00|";within:2;distance:19;byte_test:4,>,128,20,relative;reference:cve,2003-0995;reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html;reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx;classtype:attempted-admin;sid:2103159;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"NETBIOS DCERPC IActivation绑定尝试";flow:established,to_server;content:"|05|";byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|B8|J|9F|M|1C|}|CF 11 86 1E 00| |AF|n|7C|W";within:16;distance:29;flowbits:set,dce.isystemactivator.bind;classtype:protocol-command-decode;sid:2103275;rev:3;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"NETBIOS DCERPC IActivation小端绑定尝试";flow:established,to_server;content:"|05|";byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|B8|J|9F|M|1C|}|CF 11 86 1E 00| |AF|n|7C|W";within:16;distance:29;flowbits:set,dce.isystemactivator.bind;classtype:protocol-command-decode;sid:2103276;rev:3;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"NETBIOS DCERPC IrotIsRunning尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.irot;content:"|05|";byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 02|";within:2;distance:19;byte_test:4,>,128,0,relative;reference:bugtraq,6005;reference:cve,2002-1561;reference:url,www.microsoft.com/technet/security/bulletin/MS03-010.mspx;classtype:protocol-command-decode;sid:2103238;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"NETBIOS DCERPC IrotIsRunning小端尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.irot;content:"|05|";byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|02 00|";within:2;distance:19;byte_test:4,>,128,0,little,relative;reference:bugtraq,6005;reference:cve,2002-1561;reference:url,www.microsoft.com/technet/security/bulletin/MS03-010.mspx;classtype:protocol-command-decode;sid:2103239;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"NETBIOS DCERPC irot绑定尝试";flow:established,to_server;content:"|05|";depth:1;byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?";within:16;distance:29;flowbits:set,smb.tree.bind.irot;flowbits:noalert;classtype:protocol-command-decode;sid:2103236;rev:3;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"NETBIOS DCERPC irot小尾数绑定尝试";flow:established,to_server;content:"|05|";depth:1;byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?";within:16;distance:29;flowbits:set,smb.tree.bind.irot;flowbits:noalert;classtype:protocol-command-decode;sid:2103237;rev:3;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"NETBIOS DCERPC msqueue绑定尝试";flow:to_server,established;content:"|05|";depth:1;byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|B0 01|R|97 CA|Y|D0 11 A8 D5 00 A0 C9 0D 80|Q";within:16;distance:29;flowbits:set,smb.tree.bind.msqueue;flowbits:noalert;reference:cve,2003-0995;reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html;reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx;classtype:protocol-command-decode;sid:2103156;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"NETBIOS DCERPC msqueue小尾数绑定尝试";flow:to_server,established;content:"|05|";depth:1;byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|B0 01|R|97 CA|Y|D0 11 A8 D5 00 A0 C9 0D 80|Q";within:16;distance:29;flowbits:set,smb.tree.bind.msqueue;flowbits:noalert;reference:cve,2003-0995;reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html;reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx;classtype:protocol-command-decode;sid:2103157;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB CoGetInstanceFromFile和X溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.msqueue;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 01|";within:2;distance:19;byte_test:4,>,128,20,relative;reference:cve,2003-0995;reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html;reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx;classtype:attempted-admin;sid:2103180;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB CoGetInstanceFromFile小字节序和x尝试";flow:established,to_server;flowbits:isset,dce.isystemactivator.bind;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|04 00|";within:2;distance:19;content:"|5C 5C|";byte_test:4,>,256,6,little;classtype:protocol-command-decode;sid:2103430;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB CoGetInstanceFromFile小字节序和x溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.msqueue;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|01 00|";within:2;distance:19;byte_test:4,>,128,20,relative;reference:cve,2003-0995;reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html;reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx;classtype:attempted-admin;sid:2103181;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB CoGetInstanceFromFile Unicode和X尝试";flow:established,to_server;flowbits:isset,dce.isystemactivator.bind;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 04|";within:2;distance:19;content:"|5C 00 5C 00|";byte_test:4,>,256,8;classtype:protocol-command-decode;sid:2103431;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB CoGetInstanceFromFile Unicode和X溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.msqueue;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 01|";within:2;distance:19;byte_test:4,>,256,20,relative;reference:cve,2003-0995;reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html;reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx;classtype:attempted-admin;sid:2103182;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB CoGetInstanceFromFile Unicode小字节序和x尝试";flow:established,to_server;flowbits:isset,dce.isystemactivator.bind;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|04 00|";within:2;distance:19;content:"|5C 00 5C 00|";byte_test:4,>,256,8,little;classtype:protocol-command-decode;sid:2103432;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB IActivation和x绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|B8|J|9F|M|1C|}|CF 11 86 1E 00| |AF|n|7C|W";within:16;distance:29;flowbits:set,dce.iactivation.bind;flowbits:noalert;classtype:protocol-command-decode;sid:2103381;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB IActivation小字节序和x绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|B8|J|9F|M|1C|}|CF 11 86 1E 00| |AF|n|7C|W";within:16;distance:29;flowbits:set,dce.iactivation.bind;flowbits:noalert;classtype:protocol-command-decode;sid:2103382;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB IActivation Unicode和X绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|B8|J|9F|M|1C|}|CF 11 86 1E 00| |AF|n|7C|W";within:16;distance:29;flowbits:set,dce.iactivation.bind;flowbits:noalert;classtype:protocol-command-decode;sid:2103383;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB IActivation Unicode小字节序和x绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|B8|J|9F|M|1C|}|CF 11 86 1E 00| |AF|n|7C|W";within:16;distance:29;flowbits:set,dce.iactivation.bind;flowbits:noalert;classtype:protocol-command-decode;sid:2103384;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB ISystemActivator和x绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|A0 01 00 00 00 00 00 00 C0 00 00 00 00 00 00|F";within:16;distance:29;flowbits:set,dce.isystemactivator.bind;flowbits:noalert;classtype:protocol-command-decode;sid:2103397;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB ISystemActivator小端字节序和x绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|A0 01 00 00 00 00 00 00 C0 00 00 00 00 00 00|F";within:16;distance:29;flowbits:set,dce.isystemactivator.bind;flowbits:noalert;classtype:protocol-command-decode;sid:2103398;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB ISystemActivator Unicode和X绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|A0 01 00 00 00 00 00 00 C0 00 00 00 00 00 00|F";within:16;distance:29;flowbits:set,dce.isystemactivator.bind;flowbits:noalert;classtype:protocol-command-decode;sid:2103399;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB ISystemActivator unicode小字节序和x绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|A0 01 00 00 00 00 00 00 C0 00 00 00 00 00 00|F";within:16;distance:29;flowbits:set,dce.isystemactivator.bind;flowbits:noalert;classtype:protocol-command-decode;sid:2103400;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB IrotIsRunning andx尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.irot;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 02|";within:2;distance:19;byte_jump:4,8,relative,little,align;byte_test:4,>,1024,0,little;reference:bugtraq,6005;reference:cve,2002-1561;reference:url,www.microsoft.com/technet/security/bulletin/MS03-010.mspx;classtype:protocol-command-decode;sid:2103260;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB IrotIsRunning小字节序andx尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.irot;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|02 00|";within:2;distance:19;byte_jump:4,8,relative,little,align;byte_test:4,>,1024,0,little;reference:bugtraq,6005;reference:cve,2002-1561;reference:url,www.microsoft.com/technet/security/bulletin/MS03-010.mspx;classtype:protocol-command-decode;sid:2103261;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB IrotIsRunning Unicode和X尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.irot;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 02|";within:2;distance:19;byte_jump:4,8,relative,little,align;byte_test:4,>,1024,0,little;reference:bugtraq,6005;reference:cve,2002-1561;reference:url,www.microsoft.com/technet/security/bulletin/MS03-010.mspx;classtype:protocol-command-decode;sid:2103262;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB IrotIsRunning unicode小字节序andx尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.irot;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|02 00|";within:2;distance:19;byte_jump:4,8,relative,little,align;byte_test:4,>,1024,0,little;reference:bugtraq,6005;reference:cve,2002-1561;reference:url,www.microsoft.com/technet/security/bulletin/MS03-010.mspx;classtype:protocol-command-decode;sid:2103263;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS NT Trans NT创建超大的安全描述符尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB|A0|";within:5;distance:3;byte_test:1,!&,128,6,relative;pcre:"/^.{27}/R";content:"|01 00|";within:2;distance:37;byte_jump:4,-15,little,relative,from_beginning;isdataat:4,relative;byte_test:4,>,1024,40,relative,little;reference:cve,2004-1154;classtype:protocol-command-decode;sid:2103022;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB NT Trans NT创建和x超大的安全描述符尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"|A0|";depth:1;offset:39;byte_jump:2,0,little,relative;content:"|01 00|";within:2;distance:37;byte_jump:4,-15,little,relative,from_beginning;byte_test:4,>,1024,40,relative,little;reference:cve,2004-1154;classtype:protocol-command-decode;sid:2103019;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB NT Trans NT创建DACL溢出尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB|A0|";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"|01 00|";within:2;distance:64;byte_jump:4,-7,little,relative,from_beginning;content:!"|00 00 00 00|";within:4;distance:20;byte_jump:4,20,relative,little;byte_test:4,>,32,-16,relative,little;reference:cve,2004-1154;classtype:protocol-command-decode;sid:2103034;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB NT Trans NT创建SACL溢出尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB|A0|";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"|01 00|";within:2;distance:64;byte_jump:4,-7,little,relative,from_beginning;content:!"|00 00 00 00|";within:4;distance:16;byte_jump:4,16,relative,little;byte_test:4,>,32,-16,relative,little;reference:cve,2004-1154;classtype:protocol-command-decode;sid:2103026;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB NT Trans NT创建和x DACL溢出尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"|A0|";depth:1;offset:39;byte_jump:2,0,little,relative;content:"|01 00|";within:2;distance:37;byte_jump:4,-7,little,relative,from_beginning;content:!"|00 00 00 00|";within:4;distance:20;byte_jump:4,20,relative,little;byte_test:4,>,32,-16,relative,little;reference:cve,2004-1154;classtype:protocol-command-decode;sid:2103035;rev:9;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB NT Trans NT创建和x SACL溢出尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"|A0|";depth:1;offset:39;byte_jump:2,0,little,relative;content:"|01 00|";within:2;distance:37;byte_jump:4,-7,little,relative,from_beginning;content:!"|00 00 00 00|";within:4;distance:16;byte_jump:4,16,relative,little;byte_test:4,>,32,-16,relative,little;reference:cve,2004-1154;classtype:protocol-command-decode;sid:2103027;rev:6;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB NT Trans NT创建无效的SACL ace大小dos尝试";flow:stateless;content:"|00|";depth:1;content:"|FF|SMB|A0|";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"|01 00|";within:2;distance:64;byte_jump:4,-7,little,relative,from_beginning;content:!"|00 00 00 00|";within:4;distance:16;byte_jump:4,16,relative,little;content:"|00 00|";within:2;distance:-10;classtype:protocol-command-decode;sid:2103042;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB NT Trans NT创建无效的SACL ace大小dos尝试";flow:stateless;content:"|00|";depth:1;content:"|FF|SMB|A0|";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"|01 00|";within:2;distance:64;byte_jump:4,-7,little,relative,from_beginning;content:!"|00 00 00 00|";within:4;distance:20;byte_jump:4,20,relative,little;content:"|00 00|";within:2;distance:-10;classtype:protocol-command-decode;sid:2103050;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB NT Trans NT创建Unicode DACL溢出尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB|A0|";within:5;distance:3;byte_test:1,&,128,6,relative;content:"|01 00|";within:2;distance:64;byte_jump:4,-7,little,relative,from_beginning;content:!"|00 00 00 00|";within:4;distance:20;byte_jump:4,20,relative,little;byte_test:4,>,32,-16,relative,little;reference:cve,2004-1154;classtype:protocol-command-decode;sid:2103036;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB NT Trans NT创建Unicode SACL溢出尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB|A0|";within:5;distance:3;byte_test:1,&,128,6,relative;content:"|01 00|";within:2;distance:64;byte_jump:4,-7,little,relative,from_beginning;content:!"|00 00 00 00|";within:4;distance:16;byte_jump:4,16,relative,little;byte_test:4,>,32,-16,relative,little;reference:cve,2004-1154;classtype:protocol-command-decode;sid:2103028;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB NT Trans NT创建Unicode和x SACL溢出尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"|A0|";depth:1;offset:39;byte_jump:2,0,little,relative;content:"|01 00|";within:2;distance:37;byte_jump:4,-7,little,relative,from_beginning;content:!"|00 00 00 00|";within:4;distance:16;byte_jump:4,16,relative,little;byte_test:4,>,32,-16,relative,little;reference:cve,2004-1154;classtype:protocol-command-decode;sid:2103029;rev:6;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB NT Trans NT CREATE Unicode无效的SACL ace大小dos尝试";flow:stateless;content:"|00|";depth:1;content:"|FF|SMB|A0|";within:5;distance:3;byte_test:1,&,128,6,relative;content:"|01 00|";within:2;distance:64;byte_jump:4,-7,little,relative,from_beginning;content:!"|00 00 00 00|";within:4;distance:16;byte_jump:4,16,relative,little;content:"|00 00|";within:2;distance:-10;classtype:protocol-command-decode;sid:2103044;rev:6;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB NT Trans NT CREATE Unicode无效的SACL ace大小dos尝试";flow:stateless;content:"|00|";depth:1;content:"|FF|SMB|A0|";within:5;distance:3;byte_test:1,&,128,6,relative;content:"|01 00|";within:2;distance:64;byte_jump:4,-7,little,relative,from_beginning;content:!"|00 00 00 00|";within:4;distance:20;byte_jump:4,20,relative,little;content:"|00 00|";within:2;distance:-10;classtype:protocol-command-decode;sid:2103052;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS NT Trans NT创建DACL溢出尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB|A0|";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"|01 00|";within:2;distance:64;byte_jump:4,-7,little,relative,from_beginning;content:!"|00 00 00 00|";within:4;distance:20;byte_jump:4,20,relative,little;byte_test:4,>,32,-16,relative,little;reference:cve,2004-1154;classtype:protocol-command-decode;sid:2103038;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS NT Trans NT创建SACL溢出尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB|A0|";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"|01 00|";within:2;distance:64;byte_jump:4,-7,little,relative,from_beginning;content:!"|00 00 00 00|";within:4;distance:16;byte_jump:4,16,relative,little;byte_test:4,>,32,-16,relative,little;reference:cve,2004-1154;classtype:protocol-command-decode;sid:2103030;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS NT Trans NT创建无效的SACL ace大小dos尝试";flow:stateless;content:"|00|";depth:1;content:"|FF|SMB|A0|";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"|01 00|";within:2;distance:64;byte_jump:4,-7,little,relative,from_beginning;content:!"|00 00 00 00|";within:4;distance:16;byte_jump:4,16,relative,little;content:"|00 00|";within:2;distance:-10;classtype:protocol-command-decode;sid:2103046;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS NT Trans NT创建无效的SACL ace大小dos尝试";flow:stateless;content:"|00|";depth:1;content:"|FF|SMB|A0|";within:5;distance:3;byte_test:1,!&,128,6,relative;content:"|01 00|";within:2;distance:64;byte_jump:4,-7,little,relative,from_beginning;content:!"|00 00 00 00|";within:4;distance:20;byte_jump:4,20,relative,little;content:"|00 00|";within:2;distance:-10;classtype:protocol-command-decode;sid:2103054;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS NT Trans NT创建Unicode DACL溢出尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB|A0|";within:5;distance:3;byte_test:1,&,128,6,relative;content:"|01 00|";within:2;distance:64;byte_jump:4,-7,little,relative,from_beginning;content:!"|00 00 00 00|";within:4;distance:20;byte_jump:4,20,relative,little;byte_test:4,>,32,-16,relative,little;reference:cve,2004-1154;classtype:protocol-command-decode;sid:2103040;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS NT Trans NT CREATE Unicode SACL溢出尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB|A0|";within:5;distance:3;byte_test:1,&,128,6,relative;content:"|01 00|";within:2;distance:64;byte_jump:4,-7,little,relative,from_beginning;content:!"|00 00 00 00|";within:4;distance:16;byte_jump:4,16,relative,little;byte_test:4,>,32,-16,relative,little;reference:cve,2004-1154;classtype:protocol-command-decode;sid:2103032;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS NT Trans NT CREATE Unicode无效的SACL ace大小dos尝试";flow:stateless;content:"|00|";depth:1;content:"|FF|SMB|A0|";within:5;distance:3;byte_test:1,&,128,6,relative;content:"|01 00|";within:2;distance:64;byte_jump:4,-7,little,relative,from_beginning;content:!"|00 00 00 00|";within:4;distance:16;byte_jump:4,16,relative,little;content:"|00 00|";within:2;distance:-10;classtype:protocol-command-decode;sid:2103048;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS NT Trans NT CREATE Unicode无效的SACL ace大小dos尝试";flow:stateless;content:"|00|";depth:1;content:"|FF|SMB|A0|";within:5;distance:3;byte_test:1,&,128,6,relative;content:"|01 00|";within:2;distance:64;byte_jump:4,-7,little,relative,from_beginning;content:!"|00 00 00 00|";within:4;distance:20;byte_jump:4,20,relative,little;content:"|00 00|";within:2;distance:-10;classtype:protocol-command-decode;sid:2103056;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB OpenKey和x溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.winreg;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 0F|";within:2;distance:19;byte_test:2,>,1024,20,relative;reference:bugtraq,1331;reference:cve,2000-0377;classtype:attempted-admin;sid:2103222;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB OpenKey小字节序和x溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.winreg;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|0F 00|";within:2;distance:19;byte_test:2,>,1024,20,relative,little;reference:bugtraq,1331;reference:cve,2000-0377;classtype:attempted-admin;sid:2103223;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB OpenKey Unicode和X溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.winreg;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 0F|";within:2;distance:19;byte_test:2,>,2048,20,relative;reference:bugtraq,1331;reference:cve,2000-0377;classtype:attempted-admin;sid:2103224;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB OpenKey Unicode小字节序andx溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.winreg;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|0F 00|";within:2;distance:19;byte_test:2,>,2048,20,relative,little;reference:bugtraq,1331;reference:cve,2000-0377;classtype:attempted-admin;sid:2103225;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB RemoteActivation和x尝试";flow:established,to_server;flowbits:isset,dce.iactivation.bind;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 00|";within:2;distance:19;content:"|5C 5C|";byte_test:4,>,256,6;classtype:protocol-command-decode;sid:2103413;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB RemoteActivation小字节序和x尝试";flow:established,to_server;flowbits:isset,dce.iactivation.bind;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 00|";within:2;distance:19;content:"|5C 5C|";byte_test:4,>,256,6,little;classtype:protocol-command-decode;sid:2103414;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB RemoteActivation Unicode和X尝试";flow:established,to_server;flowbits:isset,dce.iactivation.bind;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 00|";within:2;distance:19;content:"|5C 00 5C 00|";byte_test:4,>,256,8;classtype:protocol-command-decode;sid:2103415;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB RemoteActivation Unicode小字节序andx尝试";flow:established,to_server;flowbits:isset,dce.iactivation.bind;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 00|";within:2;distance:19;content:"|5C 00 5C 00|";byte_test:4,>,256,8,little;classtype:protocol-command-decode;sid:2103416;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB会话设置NTMLSSP和x asn1溢出尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"s";depth:1;offset:39;byte_jump:2,0,little,relative;byte_test:4,&,2147483648,21,relative,little;content:!"NTLMSSP";within:7;distance:27;asn1:double_overflow, bitstring_overflow, relative_offset 27, oversize_length 2048;reference:bugtraq,9633;reference:bugtraq,9635;reference:cve,2003-0818;reference:nessus,12052;reference:nessus,12065;reference:url,www.microsoft.com/technet/security/bulletin/MS04-007.mspx;classtype:protocol-command-decode;sid:2103001;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB会话设置NTMLSSP Unicode和X ASN1溢出尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"s";depth:1;offset:39;byte_jump:2,0,little,relative;byte_test:4,&,2147483648,21,relative,little;content:!"NTLMSSP";within:7;distance:27;asn1:double_overflow, bitstring_overflow, relative_offset 27, oversize_length 2048;reference:bugtraq,9633;reference:bugtraq,9635;reference:cve,2003-0818;reference:nessus,12052;reference:nessus,12065;reference:url,www.microsoft.com/technet/security/bulletin/MS04-007.mspx;classtype:protocol-command-decode;sid:2103002;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB irot和x绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?";within:16;distance:29;flowbits:set,smb.tree.bind.irot;flowbits:noalert;classtype:protocol-command-decode;sid:2103244;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB irot小字节序和x绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?";within:16;distance:29;flowbits:set,smb.tree.bind.irot;flowbits:noalert;classtype:protocol-command-decode;sid:2103245;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB irot Unicode和X绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?";within:16;distance:29;flowbits:set,smb.tree.bind.irot;flowbits:noalert;classtype:protocol-command-decode;sid:2103246;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB irot unicode小字节序和x绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?";within:16;distance:29;flowbits:set,smb.tree.bind.irot;flowbits:noalert;classtype:protocol-command-decode;sid:2103247;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB llsrconnect andx溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.llsrpc;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 00|";within:2;distance:19;byte_test:4,>,52,0,relative;reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx;classtype:attempted-admin;sid:2103118;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB llsrconnect小字节序和x溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.llsrpc;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 00|";within:2;distance:19;byte_test:4,>,52,0,relative;reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx;classtype:attempted-admin;sid:2103119;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB llsrconnect Unicode和X溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.llsrpc;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 00|";within:2;distance:19;byte_test:4,>,104,0,relative;reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx;classtype:attempted-admin;sid:2103120;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB llsrconnect unicode小字节序andx溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.llsrpc;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 00|";within:2;distance:19;byte_test:4,>,104,0,relative;reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx;classtype:attempted-admin;sid:2103121;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB llsrpc和x绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m";within:16;distance:29;flowbits:set,smb.tree.bind.llsrpc;classtype:protocol-command-decode;sid:2103102;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB llsrpc小字节序和x绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m";within:16;distance:29;flowbits:set,smb.tree.bind.llsrpc;classtype:protocol-command-decode;sid:2103103;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB llsrpc Unicode和X绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m";within:16;distance:29;flowbits:set,smb.tree.bind.llsrpc;classtype:protocol-command-decode;sid:2103104;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB llsrpc unicode小尾数法和x绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m";within:16;distance:29;flowbits:set,smb.tree.bind.llsrpc;classtype:protocol-command-decode;sid:2103105;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB msqueue和x绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|B0 01|R|97 CA|Y|D0 11 A8 D5 00 A0 C9 0D 80|Q";within:16;distance:29;flowbits:set,smb.tree.bind.msqueue;flowbits:noalert;reference:cve,2003-0995;reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html;reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx;classtype:protocol-command-decode;sid:2103164;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB msqueue小字节序和x绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|B0 01|R|97 CA|Y|D0 11 A8 D5 00 A0 C9 0D 80|Q";within:16;distance:29;flowbits:set,smb.tree.bind.msqueue;flowbits:noalert;reference:cve,2003-0995;reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html;reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx;classtype:protocol-command-decode;sid:2103165;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB msqueue unicode和x绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|B0 01|R|97 CA|Y|D0 11 A8 D5 00 A0 C9 0D 80|Q";within:16;distance:29;flowbits:set,smb.tree.bind.msqueue;flowbits:noalert;reference:cve,2003-0995;reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html;reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx;classtype:protocol-command-decode;sid:2103166;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB msqueue unicode小字节序和x绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|B0 01|R|97 CA|Y|D0 11 A8 D5 00 A0 C9 0D 80|Q";within:16;distance:29;flowbits:set,smb.tree.bind.msqueue;flowbits:noalert;reference:cve,2003-0995;reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html;reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx;classtype:protocol-command-decode;sid:2103167;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB Winreg和X绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|";within:16;distance:29;flowbits:set,smb.tree.bind.winreg;flowbits:noalert;classtype:protocol-command-decode;sid:2103206;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB Winreg Little Endian andx绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|";within:16;distance:29;flowbits:set,smb.tree.bind.winreg;flowbits:noalert;classtype:protocol-command-decode;sid:2103207;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB Winreg Unicode和X绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|";within:16;distance:29;flowbits:set,smb.tree.bind.winreg;flowbits:noalert;classtype:protocol-command-decode;sid:2103208;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB winreg unicode小字节序和x绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|";within:16;distance:29;flowbits:set,smb.tree.bind.winreg;flowbits:noalert;classtype:protocol-command-decode;sid:2103209;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS CoGetInstanceFromFile和x溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.msqueue;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 01|";within:2;distance:19;byte_test:4,>,128,20,relative;reference:cve,2003-0995;reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html;reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx;classtype:attempted-admin;sid:2103188;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS CoGetInstanceFromFile小字节序和x尝试";flow:established,to_server;flowbits:isset,dce.isystemactivator.bind;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|04 00|";within:2;distance:19;content:"|5C 5C|";byte_test:4,>,256,6,little;classtype:protocol-command-decode;sid:2103438;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS CoGetInstanceFromFile小字节序和x溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.msqueue;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|01 00|";within:2;distance:19;byte_test:4,>,128,20,relative;reference:cve,2003-0995;reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html;reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx;classtype:attempted-admin;sid:2103189;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS CoGetInstanceFromFile Unicode和X尝试";flow:established,to_server;flowbits:isset,dce.isystemactivator.bind;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 04|";within:2;distance:19;content:"|5C 00 5C 00|";byte_test:4,>,256,8;classtype:protocol-command-decode;sid:2103439;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS CoGetInstanceFromFile Unicode和X溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.msqueue;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 01|";within:2;distance:19;byte_test:4,>,256,20,relative;reference:cve,2003-0995;reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html;reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx;classtype:attempted-admin;sid:2103190;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS CoGetInstanceFromFile Unicode小字节序和x尝试";flow:established,to_server;flowbits:isset,dce.isystemactivator.bind;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4;content:"|05|";byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|04 00|";within:2;distance:19;content:"|5C 00 5C 00|";byte_test:4,>,256,8,little;classtype:protocol-command-decode;sid:2103440;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS CoGetInstanceFromFile Unicode小字节序和x溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.msqueue;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|01 00|";within:2;distance:19;byte_test:4,>,256,20,relative;reference:cve,2003-0995;reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html;reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx;classtype:attempted-admin;sid:2103191;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS IActivation和x绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|B8|J|9F|M|1C|}|CF 11 86 1E 00| |AF|n|7C|W";within:16;distance:29;flowbits:set,dce.iactivation.bind;flowbits:noalert;classtype:protocol-command-decode;sid:2103389;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS IActivation小字节序和x绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|B8|J|9F|M|1C|}|CF 11 86 1E 00| |AF|n|7C|W";within:16;distance:29;flowbits:set,dce.iactivation.bind;flowbits:noalert;classtype:protocol-command-decode;sid:2103390;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS IActivation Unicode和X绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|B8|J|9F|M|1C|}|CF 11 86 1E 00| |AF|n|7C|W";within:16;distance:29;flowbits:set,dce.iactivation.bind;flowbits:noalert;classtype:protocol-command-decode;sid:2103391;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS IActivation Unicode小字节序和x绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|B8|J|9F|M|1C|}|CF 11 86 1E 00| |AF|n|7C|W";within:16;distance:29;flowbits:set,dce.iactivation.bind;flowbits:noalert;classtype:protocol-command-decode;sid:2103392;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS ISystemActivator和x绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|A0 01 00 00 00 00 00 00 C0 00 00 00 00 00 00|F";within:16;distance:29;flowbits:set,dce.isystemactivator.bind;flowbits:noalert;classtype:protocol-command-decode;sid:2103405;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS ISystemActivator小端序和x绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|A0 01 00 00 00 00 00 00 C0 00 00 00 00 00 00|F";within:16;distance:29;flowbits:set,dce.isystemactivator.bind;flowbits:noalert;classtype:protocol-command-decode;sid:2103406;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS ISystemActivator Unicode和X绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|A0 01 00 00 00 00 00 00 C0 00 00 00 00 00 00|F";within:16;distance:29;flowbits:set,dce.isystemactivator.bind;flowbits:noalert;classtype:protocol-command-decode;sid:2103407;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS ISystemActivator Unicode小字节序和x绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|A0 01 00 00 00 00 00 00 C0 00 00 00 00 00 00|F";within:16;distance:29;flowbits:set,dce.isystemactivator.bind;flowbits:noalert;classtype:protocol-command-decode;sid:2103408;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS IrotIsRunning和x尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.irot;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 02|";within:2;distance:19;byte_jump:4,8,relative,little,align;byte_test:4,>,1024,0,little;reference:bugtraq,6005;reference:cve,2002-1561;reference:url,www.microsoft.com/technet/security/bulletin/MS03-010.mspx;classtype:protocol-command-decode;sid:2103268;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS IrotIsRunning小字节序的andx尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.irot;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|02 00|";within:2;distance:19;byte_jump:4,8,relative,little,align;byte_test:4,>,1024,0,little;reference:bugtraq,6005;reference:cve,2002-1561;reference:url,www.microsoft.com/technet/security/bulletin/MS03-010.mspx;classtype:protocol-command-decode;sid:2103269;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS IrotIsRunning Unicode和X尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.irot;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 02|";within:2;distance:19;byte_jump:4,8,relative,little,align;byte_test:4,>,1024,0,little;reference:bugtraq,6005;reference:cve,2002-1561;reference:url,www.microsoft.com/technet/security/bulletin/MS03-010.mspx;classtype:protocol-command-decode;sid:2103270;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS IrotIsRunning Unicode小字节序和x尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.irot;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|02 00|";within:2;distance:19;byte_jump:4,8,relative,little,align;byte_test:4,>,1024,0,little;reference:bugtraq,6005;reference:cve,2002-1561;reference:url,www.microsoft.com/technet/security/bulletin/MS03-010.mspx;classtype:protocol-command-decode;sid:2103271;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS OpenKey和x溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.winreg;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 0F|";within:2;distance:19;byte_test:2,>,1024,20,relative;reference:bugtraq,1331;reference:cve,2000-0377;classtype:attempted-admin;sid:2103230;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS OpenKey小字节序和x溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.winreg;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|0F 00|";within:2;distance:19;byte_test:2,>,1024,20,relative,little;reference:bugtraq,1331;reference:cve,2000-0377;classtype:attempted-admin;sid:2103231;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS OpenKey Unicode和X溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.winreg;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 0F|";within:2;distance:19;byte_test:2,>,2048,20,relative;reference:bugtraq,1331;reference:cve,2000-0377;classtype:attempted-admin;sid:2103232;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS OpenKey Unicode小字节序andx溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.winreg;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|0F 00|";within:2;distance:19;byte_test:2,>,2048,20,relative,little;reference:bugtraq,1331;reference:cve,2000-0377;reference:url,www.microsoft.com/technet/security/bulletin/MS00-040.mspx;classtype:attempted-admin;sid:2103233;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS RemoteActivation和x尝试";flow:established,to_server;flowbits:isset,dce.iactivation.bind;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 00|";within:2;distance:19;content:"|5C 5C|";byte_test:4,>,256,6;classtype:protocol-command-decode;sid:2103421;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS RemoteActivation小字节序和x尝试";flow:established,to_server;flowbits:isset,dce.iactivation.bind;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 00|";within:2;distance:19;content:"|5C 5C|";byte_test:4,>,256,6,little;classtype:protocol-command-decode;sid:2103422;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS RemoteActivation Unicode和X尝试";flow:established,to_server;flowbits:isset,dce.iactivation.bind;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 00|";within:2;distance:19;content:"|5C 00 5C 00|";byte_test:4,>,256,8;classtype:protocol-command-decode;sid:2103423;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS RemoteActivation unicode小字节序和x尝试";flow:established,to_server;flowbits:isset,dce.iactivation.bind;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 00|";within:2;distance:19;content:"|5C 00 5C 00|";byte_test:4,>,256,8,little;classtype:protocol-command-decode;sid:2103424;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS irot和x绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?";within:16;distance:29;flowbits:set,smb.tree.bind.irot;flowbits:noalert;classtype:protocol-command-decode;sid:2103252;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS irot小字节序和x绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?";within:16;distance:29;flowbits:set,smb.tree.bind.irot;flowbits:noalert;classtype:protocol-command-decode;sid:2103253;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS irot Unicode和X绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?";within:16;distance:29;flowbits:set,smb.tree.bind.irot;flowbits:noalert;classtype:protocol-command-decode;sid:2103254;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS irot unicode小字节序和x绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?";within:16;distance:29;flowbits:set,smb.tree.bind.irot;flowbits:noalert;classtype:protocol-command-decode;sid:2103255;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS llsrconnect和x溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.llsrpc;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 00|";within:2;distance:19;byte_test:4,>,52,0,relative;reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx;classtype:attempted-admin;sid:2103126;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS llsrconnect小字节序和x溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.llsrpc;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 00|";within:2;distance:19;byte_test:4,>,52,0,relative;reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx;classtype:attempted-admin;sid:2103127;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS llsrconnect Unicode和X溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.llsrpc;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 00|";within:2;distance:19;byte_test:4,>,104,0,relative;reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx;classtype:attempted-admin;sid:2103128;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS llsrconnect unicode小字节序和x溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.llsrpc;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 00|";within:2;distance:19;byte_test:4,>,104,0,relative;reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx;classtype:attempted-admin;sid:2103129;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS llsrpc和x绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m";within:16;distance:29;flowbits:set,smb.tree.bind.llsrpc;classtype:protocol-command-decode;sid:2103110;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS llsrpc小字节序andx绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m";within:16;distance:29;flowbits:set,smb.tree.bind.llsrpc;classtype:protocol-command-decode;sid:2103111;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS llsrpc Unicode和X绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m";within:16;distance:29;flowbits:set,smb.tree.bind.llsrpc;classtype:protocol-command-decode;sid:2103112;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS llsrpc Unicode和X创建树尝试";flow:established,to_server;flowbits:isset,smb.tree.connect.ipc;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"|A2|";depth:1;offset:39;byte_jump:2,0,little,relative;content:"|5C 00|l|00|l|00|s|00|r|00|p|00|c|00 00 00|";within:16;distance:51;nocase;classtype:protocol-command-decode;sid:2103097;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS llsrpc Unicode小字节序和x绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m";within:16;distance:29;flowbits:set,smb.tree.bind.llsrpc;classtype:protocol-command-decode;sid:2103113;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS msqueue和x绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|B0 01|R|97 CA|Y|D0 11 A8 D5 00 A0 C9 0D 80|Q";within:16;distance:29;flowbits:set,smb.tree.bind.msqueue;flowbits:noalert;reference:cve,2003-0995;reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html;reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx;classtype:protocol-command-decode;sid:2103172;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS ms排队小字节序和x绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|B0 01|R|97 CA|Y|D0 11 A8 D5 00 A0 C9 0D 80|Q";within:16;distance:29;flowbits:set,smb.tree.bind.msqueue;flowbits:noalert;reference:cve,2003-0995;reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html;reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx;classtype:protocol-command-decode;sid:2103173;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS msqueue unicode和x绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|B0 01|R|97 CA|Y|D0 11 A8 D5 00 A0 C9 0D 80|Q";within:16;distance:29;flowbits:set,smb.tree.bind.msqueue;flowbits:noalert;reference:cve,2003-0995;reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html;reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx;classtype:protocol-command-decode;sid:2103174;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS msqueue unicode小尾数法和x绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|B0 01|R|97 CA|Y|D0 11 A8 D5 00 A0 C9 0D 80|Q";within:16;distance:29;flowbits:set,smb.tree.bind.msqueue;flowbits:noalert;reference:cve,2003-0995;reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html;reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx;classtype:protocol-command-decode;sid:2103175;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS winreg小字节序和x绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|";within:16;distance:29;flowbits:set,smb.tree.bind.winreg;flowbits:noalert;classtype:protocol-command-decode;sid:2103215;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS Winreg Unicode和X绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,!&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|";within:16;distance:29;flowbits:set,smb.tree.bind.winreg;flowbits:noalert;classtype:protocol-command-decode;sid:2103216;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS winreg unicode小字节序和x绑定尝试";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;isdataat:4,relative;content:"|05|";byte_test:1,&,16,3,relative;content:"|0B|";within:1;distance:1;content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|";within:16;distance:29;flowbits:set,smb.tree.bind.winreg;flowbits:noalert;classtype:protocol-command-decode;sid:2103217;rev:4;metadata:alarm_type 漏洞利用;)
alert udp $EXTERNAL_NET any -> $HOME_NET 1024: (msg:"NETBIOS DCERPC工作站服务直接服务访问尝试";content:"|04 00|";depth:2;byte_test:1,&,16,2,relative;content:"|98 D0 FF|k|12 A1 10|6|98|3F|C3 F8|~4Z";within:16;distance:22;reference:bugtraq,9011;reference:cve,2003-0812;reference:url,www.microsoft.com/technet/security/bulletin/MS03-049.mspx;classtype:misc-attack;sid:2102316;rev:7;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 1024: (msg:"NETBIOS DCERPC工作站服务直接服务绑定尝试";flow:to_server,established;content:"|05 00 0B|";depth:3;byte_test:1,&,16,1,relative;content:"|98 D0 FF|k|12 A1 10|6|98|3F|C3 F8|~4Z";within:16;distance:29;reference:bugtraq,9011;reference:cve,2003-0812;reference:url,www.microsoft.com/technet/security/bulletin/MS03-049.mspx;classtype:misc-attack;sid:2102315;rev:7;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS DCERPC工作站服务绑定尝试";flow:to_server,established;content:"|00|";depth:1;content:"|FF|SMB%";depth:5;offset:4;nocase;byte_test:2,^,1,5,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00 05 00 0B|";within:10;distance:4;byte_test:1,&,16,1,relative;content:"|98 D0 FF|k|12 A1 10|6|98|3F|C3 F8|~4Z";within:16;distance:29;reference:bugtraq,9011;reference:cve,2003-0812;reference:url,www.microsoft.com/technet/security/bulletin/MS03-049.mspx;classtype:misc-attack;sid:2102311;rev:8;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS DCERPC工作站服务Unicode绑定尝试";flow:to_server,established;content:"|00|";depth:1;content:"|FF|SMB%";depth:5;offset:4;nocase;byte_test:2,&,1,5,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 05 00 0B|";within:15;distance:4;byte_test:1,&,16,1,relative;content:"|98 D0 FF|k|12 A1 10|6|98|3F|C3 F8|~4Z";within:16;distance:29;reference:bugtraq,9011;reference:cve,2003-0812;reference:url,www.microsoft.com/technet/security/bulletin/MS03-049.mspx;classtype:misc-attack;sid:2102310;rev:9;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB DCERPC工作站服务绑定尝试";flow:to_server,established;content:"|00|";depth:1;content:"|FF|SMB%";depth:5;offset:4;nocase;byte_test:2,^,1,5,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00 05 00 0B|";within:10;distance:4;byte_test:1,&,16,1,relative;content:"|98 D0 FF|k|12 A1 10|6|98|3F|C3 F8|~4Z";within:16;distance:29;reference:bugtraq,9011;reference:cve,2003-0812;reference:url,www.microsoft.com/technet/security/bulletin/MS03-049.mspx;classtype:misc-attack;sid:2102309;rev:7;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB DCERPC工作站服务Unicode绑定尝试";flow:to_server,established;content:"|00|";depth:1;content:"|FF|SMB%";depth:5;offset:4;nocase;byte_test:2,&,1,5,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 05 00 0B|";within:15;distance:4;byte_test:1,&,16,1,relative;content:"|98 D0 FF|k|12 A1 10|6|98|3F|C3 F8|~4Z";within:16;distance:29;reference:bugtraq,9011;reference:cve,2003-0812;reference:url,www.microsoft.com/technet/security/bulletin/MS03-049.mspx;classtype:misc-attack;sid:2102308;rev:7;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS DCERPC Messenger Service缓冲区溢出尝试";flow:to_server,established;content:"|FF|SMB%";depth:5;offset:4;nocase;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00|";within:12;distance:5;nocase;content:"|04 00|";within:2;byte_test:1,>,15,2,relative;byte_jump:4,86,little,align,relative;byte_jump:4,8,little,align,relative;byte_test:4,>,1024,0,little,relative;reference:bugtraq,8826;reference:cve,2003-0717;reference:nessus,11888;reference:nessus,11890;reference:url,www.microsoft.com/technet/security/bulletin/MS03-043.mspx;classtype:attempted-admin;sid:2102258;rev:10;metadata:alarm_type 漏洞利用;)
alert udp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"NETBIOS DCERPC Messenger Service缓冲区溢出尝试";content:"|04 00|";depth:2;byte_test:1,>,15,2,relative;byte_jump:4,86,little,align,relative;byte_jump:4,8,little,align,relative;byte_test:4,>,1024,0,little,relative;reference:bugtraq,8826;reference:cve,2003-0717;reference:nessus,11888;reference:nessus,11890;reference:url,www.microsoft.com/technet/security/bulletin/MS03-043.mspx;classtype:attempted-admin;sid:2102257;rev:10;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS DCERPC远程激活绑定尝试";flow:to_server,established;content:"|FF|SMB%";depth:5;offset:4;nocase;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00|";within:12;distance:5;nocase;content:"|05|";within:1;content:"|0B|";within:1;distance:1;byte_test:1,&,1,0,relative;content:"|B8|J|9F|M|1C|}|CF 11 86 1E 00| |AF|n|7C|W";within:16;distance:29;tag:session,5,packets;reference:bugtraq,8234;reference:bugtraq,8458;reference:cve,2003-0528;reference:cve,2003-0605;reference:cve,2003-0715;reference:nessus,11798;reference:nessus,11835;reference:url,www.microsoft.com/technet/security/bulletin/MS03-039.mspx;classtype:attempted-admin;sid:2102252;rev:15;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"NETBIOS DCERPC远程激活绑定尝试";flow:to_server,established;content:"|05|";content:"|0B|";within:1;distance:1;byte_test:1,&,1,0,relative;content:"|B8|J|9F|M|1C|}|CF 11 86 1E 00| |AF|n|7C|W";within:16;distance:29;tag:session,5,packets;reference:bugtraq,8234;reference:bugtraq,8458;reference:cve,2003-0528;reference:cve,2003-0605;reference:cve,2003-0715;reference:nessus,11798;reference:nessus,11835;reference:url,www.microsoft.com/technet/security/bulletin/MS03-039.mspx;classtype:attempted-admin;sid:2102251;rev:16;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS DCERPC ISystemActivator绑定尝试";flow:to_server,established;content:"|FF|SMB%";depth:5;offset:4;nocase;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00|";within:12;distance:5;nocase;content:"|05|";within:1;content:"|0B|";within:1;distance:1;byte_test:1,&,1,0,relative;content:"|A0 01 00 00 00 00 00 00 C0 00 00 00 00 00 00|F";within:16;distance:29;flowbits:set,dce.isystemactivator.bind.call.attempt;reference:bugtraq,8205;reference:cve,2003-0352;reference:nessus,11808;reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx;classtype:protocol-command-decode;sid:2102193;rev:12;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB DCERPC无效的绑定尝试";flow:to_server,established;content:"|FF|SMB%";depth:5;offset:4;nocase;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00|";within:12;distance:5;nocase;content:"|05|";within:1;distance:2;content:"|0B|";within:1;distance:1;byte_test:1,&,1,0,relative;content:"|00|";within:1;distance:21;classtype:attempted-dos;sid:2102191;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"NETBIOS DCERPC无效的绑定尝试";flow:to_server,established;content:"|05|";depth:1;content:"|0B|";within:1;distance:1;byte_test:1,&,1,0,relative;content:"|00|";within:1;distance:21;classtype:attempted-dos;sid:2102190;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB启动文件夹的unicode访问";flow:to_server,established;content:"|00|";depth:1;content:"|FF|SMB2";depth:5;offset:4;content:"|5C 00|S|00|t|00|a|00|r|00|t|00| |00|M|00|e|00|n|00|u|00 5C 00|P|00|r|00|o|00|g|00|r|00|a|00|m|00|s|00 5C 00|S|00|t|00|a|00|r|00|t|00|u|00|p";distance:0;nocase;classtype:attempted-recon;sid:2102177;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp any any -> $HOME_NET 139 (msg:"NETBIOS SMB启动文件夹访问";flow:to_server,established;content:"|00|";depth:1;content:"|FF|SMB2";depth:5;offset:4;content:"Documents and Settings|5C|All Users|5C|Start Menu|5C|Programs|5C|Startup|00|";distance:0;nocase;classtype:attempted-recon;sid:2102176;rev:6;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB trans2open缓冲区溢出尝试";flow:to_server,established;content:"|00|";depth:1;content:"|FF|SMB2";depth:5;offset:4;content:"|00 14|";depth:2;offset:60;byte_test:2,>,256,0,relative,little;reference:bugtraq,7294;reference:cve,2003-0201;reference:url,www.digitaldefense.net/labs/advisories/DDI-1013.txt;classtype:attempted-admin;sid:2102103;rev:10;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"NETBIOS DCERPC LSASS绑定尝试";flow:to_server,established;content:"|05|";depth:1;content:"|00|";within:1;distance:1;byte_test:1,&,1,0,relative;content:"j|28 19|9|0C B1 D0 11 9B A8 00 C0|O|D9|.|F5|";within:16;distance:29;flowbits:set,netbios.lsass.bind.attempt;flowbits:noalert;reference:bugtraq,10108;reference:cve,2003-0533;reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx;classtype:protocol-command-decode;sid:2102507;rev:8;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB DCERPC LSASS绑定尝试";flow:to_server,established;content:"|00|";depth:1;content:"|FF|SMB%";depth:5;offset:4;nocase;byte_test:2,^,1,5,relative;content:"&|00|";within:2;distance:56;content:"|5C|PIPE|5C 00 05 00 0B|";within:10;distance:4;byte_test:1,&,16,1,relative;content:"j|28 19|9|0C B1 D0 11 9B A8 00 C0|O|D9|.|F5|";within:16;distance:29;flowbits:set,netbios.lsass.bind.attempt;flowbits:noalert;reference:bugtraq,10108;reference:cve,2003-0533;reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx;classtype:protocol-command-decode;sid:2102510;rev:8;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB DCERPC LSASS DsRolerUpgradeDownlevelServer利用尝试";flow:to_server,established;flowbits:isset,netbios.lsass.bind.attempt;content:"|FF|SMB";depth:4;offset:4;nocase;content:"|05|";distance:59;content:"|00|";within:1;distance:1;content:"|09 00|";within:2;distance:19;reference:bugtraq,10108;reference:cve,2003-0533;reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx;classtype:attempted-admin;sid:2102511;rev:10;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS DCERPC LSASS绑定尝试";flow:to_server,established;content:"|FF|SMB%";depth:5;offset:4;nocase;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00|";within:12;distance:5;nocase;content:"|05|";within:1;distance:2;content:"|0B|";within:1;distance:1;byte_test:1,&,1,0,relative;content:"j|28 19|9|0C B1 D0 11 9B A8 00 C0|O|D9|.|F5|";within:16;distance:29;flowbits:set,netbios.lsass.bind.attempt;flowbits:noalert;reference:bugtraq,10108;reference:cve,2003-0533;reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx;classtype:protocol-command-decode;sid:2102512;rev:8;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS DCERPC LSASS Unicode绑定尝试";flow:to_server,established;content:"|00|";depth:1;content:"|FF|SMB%";depth:5;offset:4;nocase;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 05 00 0B|";within:15;distance:4;byte_test:1,&,16,1,relative;content:"j|28 19|9|0C B1 D0 11 9B A8 00 C0|O|D9|.|F5|";within:16;distance:29;flowbits:set,netbios.lsass.bind.attempt;flowbits:noalert;reference:bugtraq,10108;reference:cve,2003-0533;reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx;classtype:protocol-command-decode;sid:2102513;rev:8;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 135 (msg:"NETBIOS DCERPC LSASS直接绑定尝试";flow:to_server,established;content:"|00|";depth:1;content:"|FF|SMB";depth:4;offset:4;nocase;content:"|05|";content:"|0B|";within:1;distance:1;content:"j|28 19|9|0C B1 D0 11 9B A8 00 C0|O|D9|.|F5|";within:16;distance:29;flowbits:set,netbios.lsass.bind.attempt;flowbits:noalert;reference:bugtraq,10108;reference:cve,2003-0533;reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx;classtype:protocol-command-decode;sid:2102524;rev:8;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB DCERPC LSASS直接绑定尝试";flow:to_server,established;content:"|00|";depth:1;content:"|FF|SMB";depth:4;offset:4;nocase;content:"|05|";content:"|0B|";within:1;distance:1;content:"j|28 19|9|0C B1 D0 11 9B A8 00 C0|O|D9|.|F5|";within:16;distance:29;flowbits:set,netbios.lsass.bind.attempt;flowbits:noalert;reference:bugtraq,10108;reference:cve,2003-0533;reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx;classtype:protocol-command-decode;sid:2102525;rev:7;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS DCERPC LSASS直接绑定尝试";flow:to_server,established;content:"|00|";depth:1;content:"|FF|SMB";depth:4;offset:4;nocase;content:"|05|";content:"|0B|";within:1;distance:1;content:"j|28 19|9|0C B1 D0 11 9B A8 00 C0|O|D9|.|F5|";within:16;distance:29;flowbits:set,netbios.lsass.bind.attempt;flowbits:noalert;reference:bugtraq,10108;reference:cve,2003-0533;reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx;classtype:protocol-command-decode;sid:2102526;rev:7;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"NETBIOS xp_reg *-注册表访问";flow:to_server,established;content:"x|00|p|00|_|00|r|00|e|00|g|00|";nocase;reference:bugtraq,5205;reference:cve,2002-0642;reference:nessus,10642;reference:url,www.microsoft.com/technet/security/bulletin/MS02-034;classtype:attempted-user;sid:2100686;rev:11;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 139 (msg:"NETBIOS xp_reg *注册表访问";flow:to_server,established;content:"x|00|p|00|_|00|r|00|e|00|g|00|";depth:32;offset:32;nocase;reference:bugtraq,5205;reference:cve,2002-0642;reference:nessus,10642;reference:url,www.microsoft.com/technet/security/bulletin/MS02-034;classtype:attempted-user;sid:2100689;rev:12;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB CoGetInstanceFromFile Unicode小字节序和x溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.msqueue;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-17,relative,from_beginning,little;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|01 00|";within:2;distance:19;byte_test:4,>,256,20,relative;reference:cve,2003-0995;reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html;reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx;classtype:attempted-admin;sid:2103183;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS InitiateSystemShutdown unicode小字节序和x尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.winreg;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;content:"|05|";within:1;distance:4;byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|18 00|";within:2;distance:19;classtype:protocol-command-decode;sid:2102999;rev:7;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS InitiateSystemShutdown Unicode和X尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.winreg;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 18|";within:2;distance:19;classtype:protocol-command-decode;sid:2102998;rev:6;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS InitiateSystemShutdown小端字节和x尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.winreg;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|18 00|";within:2;distance:19;classtype:protocol-command-decode;sid:2102997;rev:6;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS InitiateSystemShutdown和x尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.winreg;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 18|";within:2;distance:19;classtype:protocol-command-decode;sid:2102996;rev:6;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB InitiateSystemShutdown Unicode小字节序和x尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.winreg;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|18 00|";within:2;distance:19;classtype:protocol-command-decode;sid:2102995;rev:6;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB InitiateSystemShutdown Unicode和X尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.winreg;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 18|";within:2;distance:19;classtype:protocol-command-decode;sid:2102994;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB InitiateSystemShutdown小端字节和x尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.winreg;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;content:"|05|";distance:4;within:1;byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|18 00|";within:2;distance:19;classtype:protocol-command-decode;sid:2102993;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB InitiateSystemShutdown和x尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.winreg;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;content:"|05|";distance:4;within:1;byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 18|";within:2;distance:19;classtype:protocol-command-decode;sid:2102992;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS Winreg Unicode和X绑定尝试";flow:established,to_server;flowbits:isset,smb.tree.create.winreg;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;content:"|05|";distance:4;within:1;content:"|0B|";within:1;distance:1;content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|";within:16;distance:29;flowbits:set,smb.tree.bind.winreg;classtype:protocol-command-decode;sid:2102991;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB NDdeSetTrustedShareW和x溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.nddeapi;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;pcre:"/^.{4}/R";content:"|05|";within:1;byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 0C|";within:2;distance:19;isdataat:256,relative;content:!"|00|";within:256;distance:12;reference:bugtraq,11372;reference:cve,2004-0206;classtype:attempted-admin;sid:2102964;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB NDdeSetTrustedShareW小字节序andx溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.nddeapi;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;pcre:"/^.{4}/R";content:"|05|";within:1;byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|0C 00|";within:2;distance:19;isdataat:256,relative;content:!"|00|";within:256;distance:12;reference:bugtraq,11372;reference:cve,2004-0206;classtype:attempted-admin;sid:2102965;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB NDdeSetTrustedShareW Unicode和X溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.nddeapi;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;pcre:"/^.{4}/R";content:"|05|";within:1;byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 0C|";within:2;distance:19;isdataat:512,relative;content:!"|00 00|";within:512;distance:12;reference:bugtraq,11372;reference:cve,2004-0206;classtype:attempted-admin;sid:2102966;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB NDdeSetTrustedShareW Unicode小字节序andx溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.nddeapi;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;pcre:"/^.{4}/R";content:"|05|";within:1;byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|0C 00|";within:2;distance:19;isdataat:512,relative;content:!"|00 00|";within:512;distance:12;reference:bugtraq,11372;reference:cve,2004-0206;classtype:attempted-admin;sid:2102967;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB NTLMSSP无效的mechlistMIC尝试";flow:to_server,established;content:"|FF|SMBs";depth:5;offset:4;nocase;content:"`";depth:1;offset:63;content:"|00 00 00|b|06 83 00 00 06|+|06 01 05 05 02|";within:15;distance:1;content:"|06 0A|+|06 01 04 01 82|7|02 02 0A|";distance:0;content:"|A3|>0<|A0|0";distance:0;reference:bugtraq,9633;reference:bugtraq,9635;reference:cve,2003-0818;reference:nessus,12052;reference:nessus,12054;reference:nessus,12065;classtype:attempted-dos;sid:2102384;rev:11;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB会话设置AndX请求用户名溢出尝试";flow:to_server,established;content:"|00|";depth:1;byte_test:2,>,322,2;content:"|FF|SMBs";depth:5;offset:4;nocase;byte_test:1,<,128,6,relative;content:"|00 00 00 00|";within:4;distance:42;byte_test:2,>,255,8,relative,little;content:!"|00|";within:255;distance:10;reference:bugtraq,9752;reference:url,www.eeye.com/html/Research/Advisories/AD20040226.html;classtype:attempted-admin;sid:2102401;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB nddeapi和x绑定尝试";flow:established,to_server;flowbits:isset,smb.tree.create.nddeapi;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;pcre:"/^.{4}/R";content:"|05|";within:1;content:"|0B|";within:1;distance:1;content:" 2_/&|C1|v|10 B5|I|07|M|07 86 19 DA|";within:16;distance:29;flowbits:set,smb.tree.bind.nddeapi;reference:bugtraq,11372;reference:cve,2004-0206;classtype:protocol-command-decode;sid:2102960;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB nddeapi和x创建树尝试";flow:established,to_server;flowbits:isset,smb.tree.connect.ipc;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"|A2|";depth:1;offset:39;byte_jump:2,0,little,relative;content:"|5C|nddeapi|00|";within:9;distance:51;nocase;flowbits:set,smb.tree.create.nddeapi;reference:bugtraq,11372;reference:cve,2004-0206;classtype:protocol-command-decode;sid:2102956;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB nddeapi Unicode和X绑定尝试";flow:established,to_server;flowbits:isset,smb.tree.create.nddeapi;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;pcre:"/^.{4}/R";content:"|05|";within:1;content:"|0B|";within:1;distance:1;content:" 2_/&|C1|v|10 B5|I|07|M|07 86 19 DA|";within:16;distance:29;flowbits:set,smb.tree.bind.nddeapi;reference:bugtraq,11372;reference:cve,2004-0206;classtype:protocol-command-decode;sid:2102961;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB nddeapi unicode和x创建树尝试";flow:established,to_server;flowbits:isset,smb.tree.connect.ipc;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"|A2|";depth:1;offset:39;byte_jump:2,0,little,relative;content:"|5C 00|n|00|d|00|d|00|e|00|a|00|p|00|i|00 00 00|";within:18;distance:51;nocase;flowbits:set,smb.tree.create.nddeapi;reference:bugtraq,11372;reference:cve,2004-0206;classtype:protocol-command-decode;sid:2102957;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB Winreg和X绑定尝试";flow:established,to_server;flowbits:isset,smb.tree.create.winreg;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;pcre:"/^.{4}/R";content:"|05|";within:1;content:"|0B|";within:1;distance:1;content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|";within:16;distance:29;flowbits:set,smb.tree.bind.winreg;classtype:protocol-command-decode;sid:2102988;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB Winreg和X创建树尝试";flow:established,to_server;flowbits:isset,smb.tree.connect.ipc;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"|A2|";depth:1;offset:39;byte_jump:2,0,little,relative;content:"|5C|winreg|00|";within:8;distance:51;nocase;flowbits:set,smb.tree.create.winreg;classtype:protocol-command-decode;sid:2102984;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB Winreg Unicode和X绑定尝试";flow:established,to_server;flowbits:isset,smb.tree.create.winreg;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;pcre:"/^.{4}/R";content:"|05|";within:1;content:"|0B|";within:1;distance:1;content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|";within:16;distance:29;flowbits:set,smb.tree.bind.winreg;classtype:protocol-command-decode;sid:2102989;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS SMB Winreg Unicode和X创建树尝试";flow:established,to_server;flowbits:isset,smb.tree.connect.ipc;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"|A2|";depth:1;offset:39;byte_jump:2,0,little,relative;content:"|5C 00|w|00|i|00|n|00|r|00|e|00|g|00 00 00|";within:16;distance:51;nocase;flowbits:set,smb.tree.create.winreg;classtype:protocol-command-decode;sid:2102985;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS ADMIN $和x共享访问";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"u";depth:1;offset:39;byte_jump:2,0,little,relative;byte_jump:2,7,little,relative;content:"ADMIN|24 00|";distance:2;nocase;classtype:protocol-command-decode;sid:2102982;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS ADMIN $ Unicode和X共享访问";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"u";depth:1;offset:39;byte_jump:2,0,little,relative;byte_jump:2,7,little,relative;content:"A|00|D|00|M|00|I|00|N|00 24 00 00 00|";distance:2;nocase;classtype:protocol-command-decode;sid:2102983;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS C $ Unicode和X共享访问";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"u";depth:1;offset:39;byte_jump:2,0,little,relative;byte_jump:2,7,little,relative;content:"C|00 24 00 00 00|";distance:2;nocase;content:!"I|00|P|00|C|00 24 00 00 00|";within:10;distance:-10;nocase;classtype:protocol-command-decode;sid:2102979;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS D $ Unicode和X共享访问";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"u";depth:1;offset:39;byte_jump:2,0,little,relative;byte_jump:2,7,little,relative;content:"D|00 24 00 00 00|";distance:2;nocase;classtype:protocol-command-decode;sid:2102975;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS DCEPRC ORPC此请求泛洪尝试";flow:to_server,established;content:"|05|";depth:1;content:"|00|";within:1;distance:1;byte_test:1,&,1,0,relative;content:"|05|";within:1;distance:21;content:"MEOW";flowbits:isset,dce.isystemactivator.bind.call.attempt;threshold:type both, track by_dst, count 20, seconds 60;reference:bugtraq,8811;reference:cve,2003-0813;reference:nessus,12206;reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx;classtype:misc-attack;sid:2102496;rev:9;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS DCERPC ISystemActivator Unicode绑定尝试";flow:to_server,established;content:"|00|";depth:1;content:"|FF|SMB%";depth:5;offset:4;nocase;byte_test:2,&,1,5,relative;content:"&|00|";within:2;distance:56;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 05 00 0B|";within:15;distance:4;byte_test:1,&,16,1,relative;content:"|A0 01 00 00 00 00 00 00 C0 00 00 00 00 00 00|F";within:16;distance:29;flowbits:set,dce.isystemactivator.bind.call.attempt;reference:bugtraq,8811;reference:cve,2003-0813;reference:nessus,12206;reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx;classtype:protocol-command-decode;sid:2102491;rev:8;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS DCERPC NTLMSSP无效的机械列表MIC尝试";flow:to_server,established;content:"|FF|SMBs";depth:5;offset:4;nocase;content:"`";depth:1;offset:63;content:"|00 00 00|b|06 83 00 00 06|+|06 01 05 05 02|";within:15;distance:1;content:"|06 0A|+|06 01 04 01 82|7|02 02 0A|";distance:0;content:"|A3|>0<|A0|0";distance:0;reference:bugtraq,9633;reference:bugtraq,9635;reference:cve,2003-0818;reference:nessus,12052;reference:nessus,12054;reference:nessus,12065;classtype:attempted-dos;sid:2102385;rev:12;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS IPC $和x共享访问";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"u";depth:1;offset:39;byte_jump:2,0,little,relative;byte_jump:2,7,little,relative;content:"IPC|24 00|";distance:2;nocase;flowbits:set,smb.tree.connect.ipc;classtype:protocol-command-decode;sid:2102954;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS IPC $ Unicode和X共享访问";flow:established,to_server;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"u";depth:1;offset:39;byte_jump:2,0,little,relative;byte_jump:2,7,little,relative;content:"I|00|P|00|C|00 24 00 00 00|";distance:2;nocase;flowbits:set,smb.tree.connect.ipc;classtype:protocol-command-decode;sid:2102955;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS NDdeSetTrustedShareW andx溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.nddeapi;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;pcre:"/^.{4}/R";content:"|05|";within:1;byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 0C|";within:2;distance:19;isdataat:256,relative;content:!"|00|";within:256;distance:12;reference:bugtraq,11372;reference:cve,2004-0206;classtype:attempted-admin;sid:2102968;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS NDdeSetTrustedShareW小字节序andx溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.nddeapi;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;pcre:"/^.{4}/R";content:"|05|";within:1;byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|0C 00|";within:2;distance:19;isdataat:256,relative;content:!"|00|";within:256;distance:12;reference:bugtraq,11372;reference:cve,2004-0206;classtype:attempted-admin;sid:2102969;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS NDdeSetTrustedShareW Unicode和X溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.nddeapi;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;pcre:"/^.{4}/R";content:"|05|";within:1;byte_test:1,&,16,3,relative;content:"|00|";within:1;distance:1;content:"|00 0C|";within:2;distance:19;isdataat:512,relative;content:!"|00 00|";within:512;distance:12;reference:bugtraq,11372;reference:cve,2004-0206;classtype:attempted-admin;sid:2102970;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS NDdeSetTrustedShareW unicode小字节序和x溢出尝试";flow:established,to_server;flowbits:isset,smb.tree.bind.nddeapi;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;pcre:"/^.{4}/R";content:"|05|";within:1;byte_test:1,!&,16,3,relative;content:"|00|";within:1;distance:1;content:"|0C 00|";within:2;distance:19;isdataat:512,relative;content:!"|00 00|";within:512;distance:12;reference:bugtraq,11372;reference:cve,2004-0206;classtype:attempted-admin;sid:2102971;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS会话设置AndX请求用户名溢出尝试";flow:to_server,established;content:"|00|";depth:1;byte_test:2,>,322,2;content:"|FF|SMBs";depth:5;offset:4;nocase;byte_test:1,<,128,6,relative;content:"|00 00 00 00|";within:4;distance:42;byte_test:2,>,255,8,relative,little;content:!"|00|";within:255;distance:10;reference:bugtraq,9752;reference:url,www.eeye.com/html/Research/Advisories/AD20040226.html;classtype:attempted-admin;sid:2102402;rev:6;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS nddeapi和x绑定尝试";flow:established,to_server;flowbits:isset,smb.tree.create.nddeapi;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;pcre:"/^.{4}/R";content:"|05|";within:1;content:"|0B|";within:1;distance:1;content:" 2_/&|C1|v|10 B5|I|07|M|07 86 19 DA|";within:16;distance:29;flowbits:set,smb.tree.bind.nddeapi;reference:bugtraq,11372;reference:cve,2004-0206;classtype:protocol-command-decode;sid:2102962;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS nddeapi和x创建树尝试";flow:established,to_server;flowbits:isset,smb.tree.connect.ipc;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"|A2|";depth:1;offset:39;byte_jump:2,0,little,relative;content:"|5C|nddeapi|00|";within:9;distance:51;nocase;flowbits:set,smb.tree.create.nddeapi;reference:bugtraq,11372;reference:cve,2004-0206;classtype:protocol-command-decode;sid:2102958;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS nddeapi Unicode和X绑定尝试";flow:established,to_server;flowbits:isset,smb.tree.create.nddeapi;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;pcre:"/^.{4}/R";content:"|05|";within:1;content:"|0B|";within:1;distance:1;content:" 2_/&|C1|v|10 B5|I|07|M|07 86 19 DA|";within:16;distance:29;flowbits:set,smb.tree.bind.nddeapi;reference:bugtraq,11372;reference:cve,2004-0206;classtype:protocol-command-decode;sid:2102963;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS nddeapi Unicode和X创建树尝试";flow:established,to_server;flowbits:isset,smb.tree.connect.ipc;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"|A2|";depth:1;offset:39;byte_jump:2,0,little,relative;content:"|5C 00|n|00|d|00|d|00|e|00|a|00|p|00|i|00 00 00|";within:18;distance:51;nocase;flowbits:set,smb.tree.create.nddeapi;reference:bugtraq,11372;reference:cve,2004-0206;classtype:protocol-command-decode;sid:2102959;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS winreg和x绑定尝试";flow:established,to_server;flowbits:isset,smb.tree.create.winreg;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"%";depth:1;offset:39;byte_jump:2,0,little,relative;content:"&|00|";within:2;distance:29;content:"|5C|PIPE|5C 00|";distance:4;nocase;byte_jump:2,-10,relative,from_beginning;pcre:"/^.{4}/R";content:"|05|";within:1;content:"|0B|";within:1;distance:1;content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|";within:16;distance:29;flowbits:set,smb.tree.bind.winreg;classtype:protocol-command-decode;sid:2102990;rev:5;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS winreg和x创建树尝试";flow:established,to_server;flowbits:isset,smb.tree.connect.ipc;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\x2e|\x24|\x74)/sR";byte_test:1,!&,128,6,relative;content:"|A2|";depth:1;offset:39;byte_jump:2,0,little,relative;content:"|5C|winreg|00|";within:8;distance:51;nocase;flowbits:set,smb.tree.create.winreg;classtype:protocol-command-decode;sid:2102986;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"NETBIOS SMB-DS Winreg Unicode和X创建树尝试";flow:established,to_server;flowbits:isset,smb.tree.connect.ipc;content:"|00|";depth:1;content:"|FF|SMB";within:4;distance:3;pcre:"/^(\x75|\x2d|\x2f|\x73|\x2e|\x24|\x74)/sR";byte_test:1,&,128,6,relative;content:"|A2|";depth:1;offset:39;byte_jump:2,0,little,relative;content:"|5C 00|w|00|i|00|n|00|r|00|e|00|g|00 00 00|";within:16;distance:51;nocase;flowbits:set,smb.tree.create.winreg;classtype:protocol-command-decode;sid:2102987;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $HOME_NET 139 -> $EXTERNAL_NET any (msg:"NETBIOS SMB重复登录失败";flow:from_server,established;content:"|FF|SMB";depth:4;offset:4;content:"s";within:1;content:"m|00 00 C0|";within:4;threshold:type threshold,track by_dst,count 10,seconds 60;classtype:unsuccessful-user;sid:2102923;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $HOME_NET 445 -> $EXTERNAL_NET any (msg:"NETBIOS SMB-DS重复登录失败";flow:from_server,established;content:"|FF|SMB";depth:4;offset:4;content:"s";within:1;content:"m|00 00 C0|";within:4;threshold:type threshold,track by_dst,count 10,seconds 60;classtype:unsuccessful-user;sid:2102924;rev:4;metadata:alarm_type 漏洞利用;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 (msg:"NETBIOS RF尝试尝试";flow:to_server,established;content:"BEAVIS";content:"yep yep";reference:bugtraq,1163;reference:cve,2000-0347;reference:nessus,10392;classtype:attempted-recon;sid:2101239;rev:10;metadata:alarm_type 漏洞利用;)
alert tcp $HOME_NET [445,139] -> any any (msg:"NETBIOS PolarisOffice不安全库加载-SMB ASCII";flow:from_server;content:"SMB";offset:4;depth:5;byte_test:1,!&,0x80,7,relative;content:"puiframeworkproresenu|2E|dll";nocase;distance:0;fast_pattern;reference:url, exploit-db.com/exploits/44985/;reference:cve,2018-12589;classtype:attempted-user;sid:2025790;rev:1;metadata:alarm_type 漏洞利用;)
alert tcp $HOME_NET [445,139] -> any any (msg:"NETBIOS PolarisOffice不安全库加载-SMB Unicode";flow:from_server;content:"SMB";offset:4;depth:5;byte_test:1,&,0x80,7,relative;content:"p|00|u|00|i|00|f|00|r|00|a|00|m|00|e|00|w|00|o|00|r|00|k|00|p|00|r|00|o|00|r|00|e|00|s|00|e|00|n|00|u|00 2E 00|d|00|l|00|l|00|";nocase;distance:0;reference:url, exploit-db.com/exploits/44985/;reference:cve,2018-12589;classtype:attempted-user;sid:2025791;rev:1;metadata:alarm_type 漏洞利用;)
alert tcp any any -> $HOME_NET 445 (msg:"NETBIOS Microsoft Windows RRAS SMB远程执行代码";flow:established,to_server;content:"|21 00 00 00 10 27 00 00 a4 86 01 00 41 41 41 41 04 00 00 00 41 41 41 41 a4 86 01 00 ad 0b 2d 06 d0 ba 61 41 41 90 90 90 90 90|";reference:cve,2017-11885;reference:url,exploit-db.com/exploits/44616/;classtype:attempted-user;sid:2025824;rev:1;metadata:alarm_type 漏洞利用;)
alert tcp any any -> $HOME_NET any (msg:"NETBIOS DCERPC DCOM ExecuteShellCommand调用-可能横向移动";flow:established,to_server;content:"|00|E|00|x|00|e|00|c|00|u|00|t|00|e|00|S|00|h|00|e|00|l|00|l|00|C|00|o|00|m|00|m|00|a|00|n|00|d|00|";reference:url,enigma0x3.net/2017/01/05/lateral-movement-using-the-mmc20-application-com-object/;reference:url,enigma0x3.net/2017/01/23/lateral-movement-via-dcom-round-2/;reference:url,attack.mitre.org/techniques/T1175/;classtype:bad-unknown;sid:2027189;rev:1;metadata:alarm_type 漏洞利用;)
alert tcp any any -> $HOME_NET 135 (msg:"ET NETBIOS DCERPC SVCCTL-远程服务控制管理器访问";flow:established,to_server;content:"|00 00 00 00 00 00 00 00|";content:"|13 00 0d 81 bb 7a 36 44 98 f1 35 ad 32 98 f0 38 00 10 03|";distance:0;within:100;classtype:attempted-user;sid:2027237;rev:2;metadata:alarm_type 漏洞利用;)
