alert udp $EXTERNAL_NET 69 -> $HOME_NET any (msg:"思科TclShell TFTP下载";content:"|54 63 6C 53 68 65 6C 6C|";reference:url,wwww.irmplc.com/downloads/whitepapers/Creating_Backdoors_in_Cisco_IOS_using_Tcl.pdf;reference:url,doc.emergingthreats.net/2009245;classtype:bad-unknown;sid:2009245;rev:2;metadata:alarm_type 命令执行;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"FTP无法访问目录访问COM1";flow: established;content:"/COM1/";nocase;reference:url,doc.emergingthreats.net/bin/view/Main/2000499;classtype:string-detect;sid:2000499;rev:8;metadata:alarm_type 命令执行;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"FTP无法访问目录访问COM2";flow: established;content:"/COM2/";nocase;reference:url,doc.emergingthreats.net/bin/view/Main/2000500;classtype:string-detect;sid:2000500;rev:8;metadata:alarm_type 命令执行;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"FTP无法访问目录访问COM3";flow: established;content:"/COM3/";nocase;reference:url,doc.emergingthreats.net/bin/view/Main/2000501;classtype:string-detect;sid:2000501;rev:8;metadata:alarm_type 命令执行;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"FTP无法访问目录访问COM4";flow: established;content:"/COM4/";nocase;reference:url,doc.emergingthreats.net/bin/view/Main/2000502;classtype:string-detect;sid:2000502;rev:8;metadata:alarm_type 命令执行;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"FTP无法访问目录访问LPT1";flow: established;content:"/LPT1/";nocase;reference:url,doc.emergingthreats.net/bin/view/Main/2000503;classtype:string-detect;sid:2000503;rev:8;metadata:alarm_type 命令执行;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"FTP无法访问目录访问LPT2";flow: established;content:"/LPT2/";nocase;reference:url,doc.emergingthreats.net/bin/view/Main/2000504;classtype:string-detect;sid:2000504;rev:8;metadata:alarm_type 命令执行;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"FTP无法访问的目录访问LPT3";flow: established;content:"/LPT3/";nocase;reference:url,doc.emergingthreats.net/bin/view/Main/2000505;classtype:string-detect;sid:2000505;rev:8;metadata:alarm_type 命令执行;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"FTP无法访问目录访问LPT4";flow: established;content:"/LPT4/";nocase;reference:url,doc.emergingthreats.net/bin/view/Main/2000506;classtype:string-detect;sid:2000506;rev:8;metadata:alarm_type 命令执行;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"FTP无法访问目录访问AUX";flow: established;content:"/AUX/";nocase;reference:url,doc.emergingthreats.net/bin/view/Main/2000507;classtype:string-detect;sid:2000507;rev:8;metadata:alarm_type 命令执行;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"FTP无法访问的目录访问NULL";flow: established;content:"/NULL/";nocase;reference:url,doc.emergingthreats.net/bin/view/Main/2000508;classtype:string-detect;sid:2000508;rev:8;metadata:alarm_type 命令执行;)
alert tcp any 21 -> $HOME_NET any (msg:"敌对FTP服务器横幅（StnyFtpd）";flow:established,from_server;content:"220 StnyFtpd 0wns j0";offset:0;nocase;reference:url,doc.emergingthreats.net/bin/view/Main/2002809;classtype:trojan-activity;sid:2002809;rev:5;metadata:alarm_type 命令执行;)
alert tcp any 21 -> $HOME_NET any (msg:"敌对的FTP服务器标语（爬行动物）";flow:established,from_server;content:"220 Reptile welcomes you";offset:0;nocase;reference:url,doc.emergingthreats.net/bin/view/Main/2002810;classtype:trojan-activity;sid:2002810;rev:4;metadata:alarm_type 命令执行;)
alert tcp any 21 -> $HOME_NET any (msg:"敌对FTP服务器横幅（Bot服务器）";flow:established,from_server;content:"220 Bot Server (Win32)";offset:0;nocase;reference:url,doc.emergingthreats.net/bin/view/Main/2002811;classtype:trojan-activity;sid:2002811;rev:5;metadata:alarm_type 命令执行;)
alert tcp any [21,1024:] -> $HOME_NET any (msg:"不寻常的FTP服务器标语（fuckFtpd）";flow:established,from_server;dsize:<18;content:"220 fuckFtpd";depth:12;offset:0;nocase;reference:url,doc.emergingthreats.net/2009210;classtype:trojan-activity;sid:2009210;rev:3;metadata:alarm_type 命令执行;)
alert tcp any [21,1024:] -> $HOME_NET any (msg:"不寻常的FTP服务器标语（NzmxFtpd）";flow:established,from_server;dsize:<18;content:"220 NzmxFtpd";depth:12;offset:0;nocase;reference:url,doc.emergingthreats.net/2009211;classtype:trojan-activity;sid:2009211;rev:3;metadata:alarm_type 命令执行;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET ATTACK_RESPONSE Metasploit Meterpreter注册处检测到中断";flow:to_client,established;content:"stdapi_registry_create_key";depth:60;reference:url,www.nologin.org/Downloads/Papers/meterpreter.pdf;reference:url,doc.emergingthreats.net/2009579;classtype:successful-user;sid:2009579;rev:2;metadata:alarm_type 命令执行;)
alert tcp $HOME_NET 139 -> $EXTERNAL_NET any (msg:"ET ATTACK_RESPONSE检测到弱的Netbios Lanman Auth挑战";flow:from_server;content:"|ff 53 4d 42|";content:"|00 11 22 33 44 55 66 77 88|";reference:url,doc.emergingthreats.net/bin/view/Main/2006417;classtype:policy-violation;sid:2006417;rev:8;metadata:alarm_type 命令执行;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 21 (msg:"ET ATTACK_RESPONSE FTP CWD到Windows system32-可疑";flow:established,to_server;content:"CWD C|3a|\\WINDOWS\\system32\\";nocase;reference:url,doc.emergingthreats.net/bin/view/Main/2008556;classtype:trojan-activity;sid:2008556;rev:6;metadata:alarm_type 命令执行;)
alert tcp any 1024: -> $HOME_NET any (msg:"高端口（WinFtpd）上的不寻常的FTP服务器横幅";flow:established,from_server;dsize:<18;content:"220 WinFtpd";depth:11;offset:0;nocase;reference:url,doc.emergingthreats.net/bin/view/Main/2007725;classtype:trojan-activity;sid:2007725;rev:6;metadata:alarm_type 命令执行;)
alert tcp any 1024: -> $HOME_NET any (msg:"高端口（StnyFtpd）上的不寻常的FTP服务器横幅";flow:established,from_server;dsize:<30;content:"220 StnyFtpd";depth:12;offset:0;nocase;reference:url,doc.emergingthreats.net/bin/view/Main/2007726;classtype:trojan-activity;sid:2007726;rev:6;metadata:alarm_type 命令执行;)
alert tcp any 21 -> $HOME_NET any (msg:"不寻常的FTP服务器标语（warFTPd）";flow:established,from_server;content:"220 ";content:"--warFTPd ";depth:40;nocase;reference:url,www.warftp.org;reference:url,doc.emergingthreats.net/bin/view/Main/2003464;classtype:trojan-activity;sid:2003464;rev:5;metadata:alarm_type 命令执行;)
alert tcp any 21 -> $HOME_NET any (msg:"不寻常的FTP服务器标语（freeFTPd）";flow:established,from_server;content:"220 ";content:"--freeFTPd ";depth:40;nocase;reference:url,www.freeftp.com;reference:url,doc.emergingthreats.net/bin/view/Main/2003465;classtype:trojan-activity;sid:2003465;rev:5;metadata:alarm_type 命令执行;)
alert tcp $HOME_NET any -> any any (msg:"可能在本地系统上打开了MS CMD Shell";flow:established;dsize:<110;content:"Microsoft Windows ";depth:20;content:"Copyright 1985-20";distance:0;content:"Microsoft Corp";distance:0;content:"|0a 0a|";distance:0;reference:url,doc.emergingthreats.net/bin/view/Main/2008953;classtype:successful-admin;sid:2008953;rev:9;metadata:alarm_type 命令执行;)
alert tcp $HOME_NET any -> any any (msg:"来自本地系统的 Windows 7 CMD Shell";flow:established;dsize:<160;content:"Microsoft Windows [Version ";depth:30;content:"Copyright (c)";distance:0;content:"Microsoft Corp";distance:0;classtype:successful-admin;sid:2012690;rev:1;metadata:alarm_type 命令执行;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ID检查未返回任何人";flow:from_server,established;content:"uid=";content:"|28|nobody|29|";classtype:bad-unknown;sid:2101883;rev:7;metadata:alarm_type 命令执行;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ID检查返回的Apache";flow:from_server,established;content:"uid=";content:"|28|apache|29|";classtype:bad-unknown;sid:2101886;rev:7;metadata:alarm_type 命令执行;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"/ cgi-bin /响应的索引";flow:from_server,established;content:"Index of /cgi-bin/";nocase;reference:nessus,10039;classtype:bad-unknown;sid:2101666;rev:7;metadata:alarm_type 命令执行;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"命令完成";flow:established;content:"Command completed";nocase;reference:bugtraq,1806;classtype:bad-unknown;sid:2100494;rev:12;metadata:alarm_type 命令执行;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"命令错误";flow:established;content:"Bad command or filename";nocase;classtype:bad-unknown;sid:2100495;rev:10;metadata:alarm_type 命令执行;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"文件复制成功";flow:established;content:"1 file|28|s|29| copied";nocase;reference:bugtraq,1806;reference:cve,2000-0884;classtype:bad-unknown;sid:2100497;rev:14;metadata:alarm_type 命令执行;)
alert udp $HOME_NET 500 -> $EXTERNAL_NET 500 (msg:"isakmp登录失败";content:"|10 05|";depth:2;offset:17;content:"|00 00 00 01 01 00 00 18|";within:8;distance:13;classtype:misc-activity;sid:2102043;rev:3;metadata:alarm_type 命令执行;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"尝试删除";flow:to_server,established;content:"&del+/s+c|3A 5C|*.*";nocase;classtype:web-application-attack;sid:2101008;rev:9;metadata:alarm_type 命令执行;)
alert ip any any -> any any (msg:"id检查返回的根";content:"uid=0|28|root|29|";classtype:bad-unknown;sid:2100498;rev:7;metadata:alarm_type 命令执行;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ID检查返回的网站";flow:from_server,established;content:"uid=";content:"|28|web|29|";within:25;classtype:bad-unknown;sid:2101884;rev:8;metadata:alarm_type 命令执行;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"后门reDuh http启动";flow:to_server,established;content:"?action=checkPort&port=";http_uri;content:"Java/";http_user_agent;reference:url,www.sensepost.com/labs/tools/pentest/reduh;reference:url,doc.emergingthreats.net/2011667;classtype:trojan-activity;sid:2011667;rev:6;metadata:alarm_type 命令执行;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"后门reDuh http隧道";flow:to_server,established;content:"?action=getData&servicePort=";http_uri;content:"Java/";http_user_agent;threshold:type limit, track by_src, count 1, seconds 300;reference:url,www.sensepost.com/labs/tools/pentest/reduh;reference:url,doc.emergingthreats.net/2011668;classtype:trojan-activity;sid:2011668;rev:6;metadata:alarm_type 命令执行;)
alert tcp any any -> any any (msg:"网络用户命令响应";flow:established;content:"User accounts for |5C 5C|";fast_pattern;content:"-------------------------------------------------------------------------------";distance:0;classtype:successful-user;sid:2017025;rev:3;metadata:alarm_type 命令执行;)
alert http any any -> $HOME_NET any (msg:"非本地Burp代理错误";flow:established,to_client;content:"502";http_stat_code;content:"Bad gateway";http_stat_msg;file_data;content:"Burp proxy error|3A 20|";within:18;reference:url,portswigger.net/burp/proxy.html;classtype:successful-admin;sid:2017148;rev:3;metadata:alarm_type 命令执行;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"python shell产生尝试";flow:established,to_client;content:"pty|2e|spawn|2822|/bin/sh|2229|";depth:64;classtype:trojan-activity;sid:2017317;rev:2;metadata:alarm_type 命令执行;)
alert tcp $HOME_NET any -> any any (msg:"可能在本地系统2上打开了MS CMD Shell";dsize:<200;content:"Microsoft Windows ";depth:40;content:"[Version";distance:0;within:10;content:"Copyright (c) 2009";distance:0;content:"Microsoft Corp";distance:0;reference:url,doc.emergingthreats.net/bin/view/Main/2008953;classtype:successful-admin;sid:2018392;rev:1;metadata:alarm_type 命令执行;)
alert tcp $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"来自HTTP服务器的id命令的输出";flow:established;content:"uid=";pcre:"/^\d+[^\r\n\s]+/R";content:" gid=";within:5;pcre:"/^\d+[^\r\n\s]+/R";content:" groups=";within:8;classtype:bad-unknown;sid:2019284;rev:3;metadata:alarm_type 命令执行;)
alert udp $HOME_NET 623 -> $EXTERNAL_NET any (msg:"可能的IPMI 2.0 RAKP远程SHA1密码哈希检索RAKP消息2状态码未经授权的名称";content:"|06 13|";offset:4;depth:2;content:"|0d|";distance:11;within:1;classtype:protocol-command-decode;sid:2017121;rev:2;metadata:alarm_type 命令执行;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"Microsoft Powershell标语出站";flow:established;content:"Windows PowerShell";content:"Copyright |28|C|29| 20";distance:0;content:"Microsoft Corp";distance:0;classtype:successful-admin;sid:2020084;rev:1;metadata:alarm_type 命令执行;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"Microsoft CScript标语出站";flow:established;content:"Windows Script Host Version";content:"Copyright |28|C|29|";distance:0;content:"Microsoft Corp";distance:0;classtype:successful-admin;sid:2020085;rev:1;metadata:alarm_type 命令执行;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"Microsoft WMIC提示出站";flow:established;content:"wmic|3a|root|5c|cli>";classtype:successful-admin;sid:2020086;rev:1;metadata:alarm_type 命令执行;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"Microsoft Netsh防火墙禁用输出出站";flow:established;content:"netsh firewall|22| is deprecated|3b|";content:"use |22|netsh advfirewall";distance:0;content:"Ok.";distance:0;classtype:successful-admin;sid:2020087;rev:1;metadata:alarm_type 命令执行;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"SysInternals sc.exe输出出站";flow:established;content:"SERVICE_NAME|3a|";content:"TYPE";distance:0;content:"SERVICE_EXIT_CODE";distance:0;classtype:successful-admin;sid:2020088;rev:1;metadata:alarm_type 命令执行;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"可能通过HTTP（Linux风格）/ etc / passwd";flow:established,from_server;file_data;content:"root|3a|x|3a|0|3a|0|3a|root|3a|/root|3a|/";nocase;reference:url,doc.emergingthreats.net/bin/view/Main/2002034;classtype:successful-recon-limited;sid:2002034;rev:12;metadata:alarm_type 命令执行;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 25 (msg:"可能通过SMTP（Linux风格）/ etc / passwd";flow:established,to_server;content:"root|3a|x|3a|0|3a|0|3a|root|3a|/root|3a|/";nocase;reference:url,doc.emergingthreats.net/bin/view/Main/2003149;classtype:successful-recon-limited;sid:2003149;rev:6;metadata:alarm_type 命令执行;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 25 (msg:"可能通过SMTP（BSD风格）/ etc / passwd";flow:established,to_server;content:"root|3a|*|3a|0|3a|0|3a|";nocase;content:"|3a|/root|3a|/bin";nocase;reference:url,doc.emergingthreats.net/bin/view/Main/2003150;classtype:successful-recon-limited;sid:2003150;rev:6;metadata:alarm_type 命令执行;)
alert udp $EXTERNAL_NET any -> $HOME_NET 500 (msg:"可能的CVE-2016-1287入站反向CLI Shell代码";flow:to_server;content:"|ff ff ff|tcp/CONNECT/3/";pcre:"/^(?:\d{1,3}\.){3}\d{1,3}\/\d+\x00$/Ri";reference:url,raw.githubusercontent.com/exodusintel/disclosures/master/CVE_2016_1287_PoC;classtype:attempted-admin;sid:2022819;rev:1;metadata:alarm_type 命令执行;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"401TRG Perl DDoS IRCBot文件下载";flow:established,from_server;content:"|6d 79 20 24 70 72 6f 63 65 73 73 20 3d 20 24 72 70 73 5b 72 61 6e 64 20 73 63 61 6c 61 72 20 40 72 70 73 5d 3b|";classtype:trojan-activity;sid:2024977;rev:2;metadata:alarm_type 命令执行;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"webr00t WebShell访问";flow:established,to_server;content:"/?webr00t=";http_uri;reference:url,blog.sucuri.net/2013/11/case-study-analyzing-a-wordpress-attack-dissecting-the-webr00t-cgi-shell-part-i.html;classtype:trojan-activity;sid:2017701;rev:4;metadata:alarm_type 命令执行;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"OptimizePress上传目录中的 PHP脚本可能的WebShell访问";flow:to_server,established;content:"/wp-content/uploads/optpress/images_";http_uri;fast_pattern:16,20;content:".php";http_uri;pcre:"/\/wp-content\/uploads\/optpress\/images\_(?:comingsoon|lncthumbs|optbuttons)\/.*?\.php/Ui";reference:url,blog.sucuri.net/2013/12/wordpress-optimizepress-theme-file-upload-vulnerability.html;classtype:attempted-admin;sid:2017854;rev:3;metadata:alarm_type 命令执行;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"Linksys路由器将设备设置返回到外部源";flow:established,from_server;file_data;content:"<GetDeviceSettingsResponse>";content:"<GetDeviceSettingsResult>";content:"<ModelName>";reference:url,isc.sans.edu/forums/diary/Linksys+Worm+TheMoon+Summary+What+we+know+so+far/17633;classtype:attempted-admin;sid:2018136;rev:3;metadata:alarm_type 命令执行;)
alert http [$HOME_NET,$HTTP_SERVERS] any -> $EXTERNAL_NET any (msg:"Zone-H.org污损通知";flow:established,to_server;content:"POST";http_method;content:"/notify/";http_uri;pcre:"/\/notify\/(single|mass)$/iU";content:"defacer|3d|";http_client_body;depth:8;fast_pattern;reference:url,doc.emergingthreats.net/bin/view/Main/2001616;classtype:trojan-activity;sid:2001616;rev:14;metadata:alarm_type 命令执行;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"WSO-WebShell活动-WSO标题";flow:established,to_client;file_data;content:"<title>";content:" - WSO ";fast_pattern;distance:0;content:"</title>";distance:0;classtype:attempted-user;sid:2015905;rev:3;metadata:alarm_type 命令执行;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"WSO-WebShell活动-POST结构";flow:established,to_server;content:"POST";http_method;content:"&c=";http_client_body;content:"&p1=";http_client_body;content:"&p2=";http_client_body;content:"&p3=";http_client_body;fast_pattern;pcre:"/a=(?:S(?:e(?:lfRemove|cInfo)|tringTools|afeMode|ql)|(?:Bruteforc|Consol)e|FilesMan|Network|Logout|Php)/P";classtype:attempted-user;sid:2015906;rev:3;metadata:alarm_type 命令执行;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"passwd文件从WEB SERVER Linux出站";flow:established,from_server;file_data;content:"root:x:0:0:root:/root:/bin/";within:27;classtype:successful-recon-limited;sid:2025879;rev:1;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"DNS TXT响应中的PowerShell执行字符串Base64编码的新对象（V3LU9）";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"V3LU9";fast_pattern;distance:0;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026920;rev:3;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"DNS TXT响应中的PowerShell执行字符串Base64编码的新对象（ctT2J）";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"ctT2J";fast_pattern;distance:0;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026921;rev:3;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"DNS TXT响应中的PowerShell执行字符串Base64编码的新对象（dy1PYmp）";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"dy1PYmp";fast_pattern;distance:0;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026922;rev:3;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"DNS TXT响应中的PowerShell执行字符串Base64编码的新对象（V3LU9iam）";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"V3LU9iam";fast_pattern;distance:0;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026923;rev:3;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"DNS TXT响应中的PowerShell执行字符串Base64编码的新对象（XctT2JqZW）";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"XctT2JqZW";fast_pattern;distance:0;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026924;rev:3;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"DNS TXT响应中的PowerShell执行字符串Base64编码的新对象（dy1PYmplY3）";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"dy1PYmplY3";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026925;rev:2;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"DNS TXT响应中的PowerShell执行字符串Base64编码的启动过程（FydC1Qcm9）";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"FydC1Qcm9";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026926;rev:2;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"DNS TXT响应中的PowerShell执行字符串Base64编码的启动过程（RhcnQtUHJ）";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"RhcnQtUHJ";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026927;rev:2;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"DNS TXT响应中的PowerShell执行字符串Base64编码的启动过程（YXJ0LVByb2N）";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"YXJ0LVByb2N";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026928;rev:2;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"DNS TXT响应中的PowerShell执行字符串Base64编码的启动过程（RhcnQtUHJvY2）";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"RhcnQtUHJvY2";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026929;rev:2;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"DNS TXT响应中的PowerShell执行字符串Base64编码的启动过程（GFydC1Qcm9jZX）";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"GFydC1Qcm9jZX";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026930;rev:2;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"DNS TXT响应中的PowerShell执行字符串Base64编码的启动过程（YXJ0LVByb2Nlc3）";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"YXJ0LVByb2Nlc3";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026931;rev:2;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"DNS TXT响应中的PowerShell执行字符串Base64编码的Invoke-WmiMethod（Zva2UtV21pTWV）";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"Zva2UtV21pTWV";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026932;rev:2;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"DNS TXT响应中的PowerShell执行字符串Base64编码的Invoke-WmiMethod（52b2tlLVdtaU1）";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"52b2tlLVdtaU1";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026933;rev:2;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"DNS TXT响应中的PowerShell执行字符串Base64编码的Invoke-WmiMethod（dm9rZS1XbWlNZXR）";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"dm9rZS1XbWlNZXR";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026934;rev:2;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"DNS TXT响应中的PowerShell执行字符串Base64编码的Invoke-WmiMethod（52b2tlLVdtaU1ldG）";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"52b2tlLVdtaU1ldG";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026935;rev:2;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"DNS TXT响应中的PowerShell执行字符串Base64编码的Invoke-WmiMethod（nZva2UtV21pTWV0aG）";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"nZva2UtV21pTWV0aG";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026936;rev:2;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"DNS TXT响应中的PowerShell执行字符串Base64编码的Invoke-WmiMethod（dm9rZS1XbWlNZXRob2）";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"dm9rZS1XbWlNZXRob2";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026937;rev:2;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"DNS TXT响应中的 PowerShell执行字符串Base64编码的调用命令（Zva2UtQ29）";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"Zva2UtQ29";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026938;rev:2;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"DNS TXT响应中的 PowerShell执行字符串Base64编码的调用命令（dm9rZS1Db21）";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"dm9rZS1Db21";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026939;rev:2;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"DNS TXT响应中的PowerShell执行字符串Base64编码的调用命令（nZva2UtQ29tbW）";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"nZva2UtQ29tbW";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026940;rev:2;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"DNS TXT响应中的PowerShell执行字符串Base64编码的调用命令（52b2tlLUNvbW1）";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"52b2tlLUNvbW1";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026941;rev:2;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"DNS TXT响应中的 PowerShell执行字符串Base64编码的调用命令（dm9rZS1Db21tYW）";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"dm9rZS1Db21tYW";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026942;rev:2;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"DNS TXT响应中的 PowerShell执行字符串Base64编码的调用命令（52b2tlLUNvbW1hbm）";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"52b2tlLUNvbW1hbm";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2026943;rev:2;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"UTF8 base64字符串/ DNS TXT响应中的此程序/";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"hpcyBwcm9";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2027027;rev:2;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"UTF8 base64字符串/ DNS TXT响应中的此程序/";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"lzIHByb2d";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2027028;rev:2;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"UTF8 base64字符串/ DNS TXT响应中的此程序/";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"aXMgcHJvZ3J";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2027029;rev:2;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"UTF16-LE base64字符串/ DNS TXT响应中的此程序/";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"hpcyBwcm9ncm";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2027030;rev:2;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"UTF16-LE base64字符串/ DNS TXT响应中的此程序/";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"GlzIHByb2dyYW";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2027031;rev:2;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"UTF16-LE base64字符串/ DNS TXT响应中的此程序/";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"aXMgcHJvZ3JhbS";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2027032;rev:2;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"UTF8 base64宽字符串/此程序/在DNS TXT响应中";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"gAaQBzACAAcAByAG8AZwByAGE";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2027033;rev:2;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"UTF8 base64宽字符串/此程序/在DNS TXT响应中";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"BoAGkAcwAgAHAAcgBvAGcAcgB";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2027034;rev:2;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"UTF8 base64宽字符串/此程序/在DNS TXT响应中";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"aABpAHMAIABwAHIAbwBnAHIAYQB";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2027035;rev:2;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"DNS TXT响应中的 UTF16-LE base64宽字符串/ This Program /";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"BoAGkAcwAgAHAAcgBvAGcAcgBhAG";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2027036;rev:2;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"DNS TXT响应中的 UTF16-LE base64宽字符串/ This Program /";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"GgAaQBzACAAcAByAG8AZwByAGEAbQ";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2027037;rev:2;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"DNS TXT响应中的 UTF16-LE base64宽字符串/ This Program /";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"aABpAHMAIABwAHIAbwBnAHIAYQBtAC";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2027038;rev:2;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"UTF8 base64反向字符串/ DNS TXT响应中的此程序/";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"FyZ29ycCB";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2027039;rev:2;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"UTF8 base64反向字符串/ DNS TXT响应中的此程序/";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"1hcmdvcnA";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2027040;rev:2;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"UTF8 base64反向字符串/ DNS TXT响应中的此程序/";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"YXJnb3JwIHN";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2027041;rev:2;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"UTF16 base64反向字符串/ DNS TXT响应中的此程序/";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"1hcmdvcnAgc2";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2027042;rev:2;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"UTF16 base64反向字符串/ DNS TXT响应中的此程序/";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"WFyZ29ycCBzaW";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2027043;rev:2;metadata:alarm_type 命令执行;)
alert dns any any -> $HOME_NET any (msg:"UTF16 base64反向字符串/ DNS TXT响应中的此程序/";content:"|00 00 10 00 01 c0 0c 00 10 00 01|";content:"YXJnb3JwIHNpaF";distance:0;fast_pattern;reference:url,github.com/no0be/DNSlivery;classtype:bad-unknown;sid:2027044;rev:2;metadata:alarm_type 命令执行;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [1024:] (msg:"FTP中的 LaZagne神器出站";flow:established,to_server;content:"The LaZagne Project";fast_pattern;reference:url,github.com/AlessandroZ/LaZagne;classtype:trojan-activity;sid:2027151;rev:2;metadata:alarm_type 命令执行;)
alert http any any -> $HOME_NET any (msg:"通过HTTP M1入站的 Windows SCM DLL劫持命令";flow:established,from_server;content:"200";http_stat_code;file_data;content:"stop|20|IKEEXT";content:"copy|20|wlbsctrl.dll";content:"|5c|Windows|5c|System32|5c|wlbsctrl.dll";distance:0;fast_pattern;reference:url,posts.specterops.io/lateral-movement-scm-and-dll-hijacking-primer-d2f61e8ab992;classtype:attempted-user;sid:2027232;rev:2;metadata:alarm_type 命令执行;)
alert http any any -> $HOME_NET any (msg:"通过HTTP M2入站的 Windows SCM DLL劫持命令";flow:established,from_server;content:"200";http_stat_code;file_data;content:"stop|20|SessionEnv";content:"copy|20|TSMSISrv.dll";content:"|5c|Windows|5c|System32|5c|TSMSISrv.dll";distance:0;fast_pattern;reference:url,posts.specterops.io/lateral-movement-scm-and-dll-hijacking-primer-d2f61e8ab992;classtype:attempted-user;sid:2027233;rev:2;metadata:alarm_type 命令执行;)
alert http any any -> $HOME_NET any (msg:"Windows SCM DLL劫持命令（UTF-16）通过HTTP M1入站";flow:established,from_server;content:"200";http_stat_code;file_data;content:"|00|s|00|t|00|o|00|p|00 20 00|I|00|K|00|E|00|E|00|X|00|T|00|";content:"|00|c|00|o|00|p|00|y|00 20 00|w|00|l|00|b|00|s|00|c|00|t|00|r|00|l|00|.|00|d|00|l|00|l|00|";content:"|00 5c 00|W|00|i|00|n|00|d|00|o|00|w|00|s|00 5c 00|S|00|y|00|s|00|t|00|e|00|m|00|3|00|2|00 5c 00|w|00|l|00|b|00|s|00|c|00|t|00|r|00|l|00|.|00|d|00|l|00|l|00|";distance:0;fast_pattern;reference:url,posts.specterops.io/lateral-movement-scm-and-dll-hijacking-primer-d2f61e8ab992;classtype:attempted-user;sid:2027234;rev:2;metadata:alarm_type 命令执行;)
alert http any any -> $HOME_NET any (msg:"Windows SCM DLL劫持命令（UTF-16）通过HTTP M2入站";flow:established,from_server;content:"200";http_stat_code;file_data;content:"|00|s|00|t|00|o|00|p|00 20 00|S|00|e|00|s|00|s|00|i|00|o|00|n|00|E|00|n|00|v|00|";content:"|00|c|00|o|00|p|00|y|00 20 00|T|00|S|00|M|00|S|00|I|00|S|00|r|00|v|00|.|00|d|00|l|00|l|00|";content:"|00 5c 00|W|00|i|00|n|00|d|00|o|00|w|00|s|00 5c 00|S|00|y|00|s|00|t|00|e|00|m|00|3|00|2|00 5c 00|T|00|S|00|M|00|S|00|I|00|S|00|r|00|v|00|.|00|d|00|l|00|l|00|";distance:0;fast_pattern;reference:url,posts.specterops.io/lateral-movement-scm-and-dll-hijacking-primer-d2f61e8ab992;classtype:attempted-user;sid:2027235;rev:2;metadata:alarm_type 命令执行;)
alert http any any -> $HOME_NET any (msg:"通过HTTP M3入站的 Windows SCM DLL劫持命令";flow:established,from_server;content:"200";http_stat_code;file_data;content:"stop|20|";content:"copy|20|TSVIPSrv.dll";content:"|5c|Windows|5c|System32|5c|TSVIPSrv.dll";distance:0;fast_pattern;reference:url,posts.specterops.io/lateral-movement-scm-and-dll-hijacking-primer-d2f61e8ab992;classtype:attempted-user;sid:2027236;rev:2;metadata:alarm_type 命令执行;)
alert http any any -> $HOME_NET any (msg:"Windows SCM DLL劫持命令（UTF-16）通过HTTP M3入站";flow:established,from_server;content:"200";http_stat_code;file_data;content:"|00|s|00|t|00|o|00|p|00 20 00|";content:"|00|c|00|o|00|p|00|y|00 20 00|T|00|S|00|V|00|I|00|P|00|S|00|r|00|v|00|.|00|d|00|l|00|l|00|";content:"|00 5c 00|W|00|i|00|n|00|d|00|o|00|w|00|s|00 5c 00|S|00|y|00|s|00|t|00|e|00|m|00|3|00|2|00 5c 00|T|00|S|00|M|00|S|00|I|00|S|00|r|00|v|00|.|00|d|00|l|00|l|00|";distance:0;fast_pattern;reference:url,posts.specterops.io/lateral-movement-scm-and-dll-hijacking-primer-d2f61e8ab992;classtype:attempted-user;sid:2027238;rev:3;metadata:alarm_type 命令执行;)
alert smb any any -> $HOME_NET any (msg:"可能的横向移动-远程System32目录中的文件创建请求（T1105）";flow:established,to_server;content:"|05 00|";offset:16;depth:2;content:"|00|W|00|i|00|n|00|d|00|o|00|w|00|s|00 5c 00|S|00|y|00|s|00|t|00|e|00|m|00|3|00|2|00|";fast_pattern;classtype:attempted-user;sid:2027267;rev:2;metadata:alarm_type 命令执行;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"Windows 64位procdump转储文件渗透";flow:established,to_server;content:"|00 2a 00 2a 00 2a 00 20 00|p|00|r|00|o|00|c|00|d|00|u|00|m|00|p|00|6|00|4|00 2e 00|e|00|x|00|e";fast_pattern;reference:url,attack.mitre.org/techniques/T1003/;classtype:attempted-admin;sid:2027435;rev:2;metadata:alarm_type 命令执行;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"Windows 32位procdump转储文件渗透";flow:established,to_server;content:"|00 2a 00 2a 00 2a 00 20 00|p|00|r|00|o|00|c|00|d|00|u|00|m|00|p|00 2e 00|e|00|x|00|e";fast_pattern;reference:url,attack.mitre.org/techniques/T1003/;classtype:attempted-admin;sid:2027436;rev:2;metadata:alarm_type 命令执行;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"目录清单";flow:to_server,established;content:"/ServerVariables_Jscript.asp";http_uri;nocase;reference:nessus,10573;classtype:web-application-attack;sid:2101009;rev:9;metadata:alarm_type 命令执行;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"Windows LMHosts文件下载-可能是DNSChanger感染";flow:established,to_client;content:"#|0d 0a|#|20|This|20|is|20|a|20|sample|20|HOSTS|20|file|20|used|20|by|20|Microsoft|20|TCP/IP|20|for|20|Windows.|0d 0a|#|0d 0a|#|20|This|20|file|20|contains|20|the|20|mappings|20|of|20|IP|20|addresses|20|to|20|host|20|names.";reference:url,doc.emergingthreats.net/bin/view/Main/2008559;classtype:trojan-activity;sid:2008559;rev:8;metadata:alarm_type 命令执行;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"r57 phpshell页脚已检测到";flow:established,from_server;content:"r57shell - http-shell by RST/GHC";reference:url,www.pestpatrol.com/spywarecenter/pest.aspx?id=453096755;reference:url,doc.emergingthreats.net/bin/view/Main/2003535;classtype:web-application-activity;sid:2003535;rev:8;metadata:alarm_type 命令执行;)
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"检测到 x2300 phpshell";flow:established,from_server;content:"x2300 Locus7Shell";reference:url,www.rfxn.com/vdb.php;reference:url,doc.emergingthreats.net/bin/view/Main/2007651;classtype:web-application-activity;sid:2007651;rev:7;metadata:alarm_type 命令执行;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"可能通过HTTP（BSD风格）/ etc / passwd";flow:established,from_server;file_data;content:"root|3a|*|3a|0|3a|0|3a|";nocase;content:"|3a|/root|3a|/bin";nocase;reference:url,doc.emergingthreats.net/bin/view/Main/2003071;classtype:successful-recon-limited;sid:2003071;rev:9;metadata:alarm_type 命令执行;)
alert tcp $SQL_SERVERS 3306 -> $EXTERNAL_NET any (msg:"MySQL用户帐户枚举";flow:from_server,established;content:"|02|";offset:3;depth:4;content:"|15 04|Access denied for user";fast_pattern;threshold:type both,track by_dst,count 10,seconds 1;reference:url,seclists.org/fulldisclosure/2012/Dec/att-9/;classtype:protocol-command-decode;sid:2015993;rev:3;metadata:alarm_type 暴力破解;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"Matahari客户端";flow:to_server,established;content:"Accept|2d|Encoding|3a 20|identity|0d 0a|";http_header;content:"Next|2d|Polling";http_header;fast_pattern;content:"Content|2d|Salt|3a 20|";http_header;pcre:"/Content\x2dSalt\x3a\x20[0-9\.\-]+\x0d\x0a/Hi";reference:url,doc.emergingthreats.net/2010795;classtype:trojan-activity;sid:2010795;rev:11;metadata:alarm_type 命令执行;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"Metasploit Meterpreter反向HTTPS证书";flow:from_server,established;content:"|A3 0D 30 0B 30 09 06 03 55 1D 13 04 02 30 00|";fast_pattern;content:"|16 03 03|";pcre:"/^..\x0B.{9}\x30\x82..\x30\x82..\xA0\x03\x02\x01\x02\x02(?:\x09.{9}|\x08.{8})/Rs";content:"|30 0D 06 09 2A 86 48 86 F7 0D 01 01 0B 05 00 30|";within:16;pcre:"/^.\x31.\x30.\x06\x03\x55\x04\x03\x0C.([a-z]{2,9})\x30.\x17\x0D[0-9]{12}Z\x17\x0D[0-9]{12}Z\x30.\x31.\x30.\x06\x03\x55\x04\x03\x0C.\g{1}\x30\x82../Rs";content:"|30 0D 06 09 2A 86 48 86 F7 0D 01 01 01 05 00 03 82|";within:17;pcre:"/^...\x30\x82..\x02\x82...{256,257}/Rs";content:"|02 03 01 00 01 A3 0D 30 0B 30 09 06 03 55 1D 13 04 02 30 00 30 0D 06 09 2A 86 48 86 F7 0D 01 01 0B 05 00|";within:36;content:!"|06|ubuntu";content:!"|04|mint";content:!"|a9 d5 73 d2 a0 a5 a1 69|";reference:url,blog.didierstevens.com/2015/05/11/detecting-network-traffic-from-metasploits-meterpreter-reverse-http-module;classtype:trojan-activity;sid:2021178;rev:7;metadata:alarm_type 命令执行;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"可能的BeEF HTTP标头入站";flow:established,from_server;content:"Content-Type|3a 20|text/javascript|0d 0a|Server|3a 20|Apache/2.2.3 (CentOS)|0d 0a|Pragma|3a|";fast_pattern;http_header;depth:69;content:"|0d 0a|Expires|3a 20|0|0d 0a|";http_header;http_header_names;content:!"Set-Cookie|0d 0a|";content:!"X-Powered-By|0d 0a|";classtype:attempted-user;sid:2024421;rev:3;metadata:alarm_type 命令执行;)
