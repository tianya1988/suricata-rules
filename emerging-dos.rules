alert tcp $HOME_NET 3389 -> any any (msg:"Microsoft远程桌面（RDP）Syn / Ack出站流量位集";flow:from_server;flags:SA;flowbits:isnotset,ms.rdp.synack;flowbits:set,ms.rdp.synack;flowbits:noalert;reference:cve,2012-0152;classtype:not-suspicious;sid:2014385;rev:5;metadata:alarm_type DDoS;)
alert udp $EXTERNAL_NET any -> $HOME_NET 1900 (msg:"LibuPnP CVE-2012-5963 ST UDN缓冲区溢出";content:"|0D 0A|ST|3A|";nocase;pcre:"/^[^\r\n]*uuid\x3a[^\r\n\x3a]{181}/Ri";reference:cve,CVE-2012-5963;classtype:attempted-dos;sid:2016323;rev:1;metadata:alarm_type DDoS;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"CVE-2013-0230 Miniupnpd SoapAction方法名称缓冲区溢出";flow:to_server,established;content:"POST ";depth:5;content:"|0d 0a|SOAPAction|3a|";nocase;distance:0;pcre:"/^[^\r\n]+#[^\x22\r\n]{2049}/R";reference:url,community.rapid7.com/community/infosec/blog/2013/01/29/security-flaws-in-universal-plug-and-play-unplug-dont-play;reference:url,upnp.org/specs/arch/UPnP-arch-DeviceArchitecture-v1.1.pdf;reference:cve,CVE-2013-0230;classtype:attempted-dos;sid:2016364;rev:1;metadata:alarm_type DDoS;)
alert udp any any -> $HOME_NET 1900 (msg:"Miniupnpd M-SEARCH缓冲区溢出CVE-2013-0229";content:"M-SEARCH";depth:8;isdataat:1492,relative;content:!"|0d 0a|";distance:1490;within:2;reference:url,community.rapid7.com/community/infosec/blog/2013/01/29/security-flaws-in-universal-plug-and-play-unplug-dont-play;reference:url,upnp.org/specs/arch/UPnP-arch-DeviceArchitecture-v1.1.pdf;reference:cve,CVE-2013-0229;classtype:attempted-dos;sid:2016363;rev:2;metadata:alarm_type DDoS;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"Trojan.BlackRev V1.Botnet HTTP登录POST泛洪流量入站";flow:established,to_server;content:"POST";http_method;content:"Mozilla/4.0 (compatible|3B| Synapse)";fast_pattern:24,9;http_user_agent;content:"login=";http_client_body;depth:6;content:"$pass=";http_client_body;within:50;threshold: type both, count 5, seconds 60, track by_src;reference:url,www.btpro.net/blog/2013/05/black-revolution-botnet-trojan/;classtype:attempted-dos;sid:2017722;rev:3;metadata:alarm_type DDoS;)
alert udp any any -> any 123 (msg:"可能的NTP DDoS入站频繁未经授权的MON_LIST请求IMPL 0x02";content:"|00 02 2A|";offset:1;depth:3;byte_test:1,!&,128,0;byte_test:1,&,4,0;byte_test:1,&,2,0;byte_test:1,&,1,0;threshold: type both,track by_dst,count 2,seconds 60;reference:url,www.symantec.com/connect/blogs/hackers-spend-christmas-break-launching-large-scale-ntp-reflection-attacks;classtype:attempted-dos;sid:2017918;rev:2;metadata:alarm_type DDoS;)
alert udp any any -> any 123 (msg:"可能的NTP DDoS入站频繁未经授权的MON_LIST请求IMPL 0x03";content:"|00 03 2A|";offset:1;depth:3;byte_test:1,!&,128,0;byte_test:1,&,4,0;byte_test:1,&,2,0;byte_test:1,&,1,0;threshold: type both,track by_dst,count 2,seconds 60;reference:url,www.symantec.com/connect/blogs/hackers-spend-christmas-break-launching-large-scale-ntp-reflection-attacks;classtype:attempted-dos;sid:2017919;rev:2;metadata:alarm_type DDoS;)
alert udp $HOME_NET 123 -> $EXTERNAL_NET any (msg:"可能的NTP DDoS多个MON_LIST Seq 0响应跨越多个数据包IMPL 0x02";content:"|00 02 2a|";offset:1;depth:3;byte_test:1,&,128,0;byte_test:1,&,64,0;byte_test:1,&,4,0;byte_test:1,&,2,0;byte_test:1,&,1,0;threshold: type both,track by_src,count 2,seconds 60;reference:url,www.symantec.com/connect/blogs/hackers-spend-christmas-break-launching-large-scale-ntp-reflection-attacks;classtype:attempted-dos;sid:2017920;rev:2;metadata:alarm_type DDoS;)
alert udp $HOME_NET 123 -> $EXTERNAL_NET any (msg:"可能的NTP DDoS多个MON_LIST Seq 0响应跨越多个数据包IMPL 0x03";content:"|00 03 2a|";offset:1;depth:3;byte_test:1,&,128,0;byte_test:1,&,64,0;byte_test:1,&,4,0;byte_test:1,&,2,0;byte_test:1,&,1,0;threshold: type both,track by_src,count 2,seconds 60;reference:url,www.symantec.com/connect/blogs/hackers-spend-christmas-break-launching-large-scale-ntp-reflection-attacks;classtype:attempted-dos;sid:2017921;rev:2;metadata:alarm_type DDoS;)
alert udp any 123 -> any 0:1023 (msg:"可能正在进行NTP DDoS MON_LIST对非临时端口IMPL 0x02的响应";content:"|00 02 2a|";offset:1;depth:3;byte_test:1,&,128,0;byte_test:1,&,64,0;byte_test:1,&,4,0;byte_test:1,&,2,0;byte_test:1,&,1,0;threshold: type both,track by_src,count 1,seconds 120;reference:url,www.symantec.com/connect/blogs/hackers-spend-christmas-break-launching-large-scale-ntp-reflection-attacks;reference:url,en.wikipedia.org/wiki/Ephemeral_port;classtype:attempted-dos;sid:2017965;rev:3;metadata:alarm_type DDoS;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"入站GoldenEye DoS攻击";flow:established,to_server;content:"/?";fast_pattern;http_uri;depth:2;content:"=";http_uri;distance:3;within:11;pcre:"/^\/\?[a-zA-Z0-9]{3,10}=[a-zA-Z0-9]{3,20}(?:&[a-zA-Z0-9]{3,10}=[a-zA-Z0-9]{3,20})*?$/U";content:"Keep|2d|Alive|3a|";http_header;content:"Connection|3a| keep|2d|alive";http_header;content:"Cache|2d|Control|3a|";http_header;pcre:"/^Cache-Control\x3a\x20(?:max-age=0|no-cache)\r?$/Hm";content:"Accept|2d|Encoding|3a|";http_header;threshold: type both, track by_src, count 100, seconds 300;reference:url,github.com/jseidl/GoldenEye;classtype:denial-of-service;sid:2018208;rev:2;metadata:alarm_type DDoS;)
alert udp any 123 -> any 0:1023 (msg:"可能正在进行NTP DDoS的PEER_LIST对非临时端口IMPL 0x02的响应";content:"|00 02 00|";offset:1;depth:3;byte_test:1,&,128,0;byte_test:1,&,64,0;byte_test:1,&,4,0;byte_test:1,&,2,0;byte_test:1,&,1,0;threshold: type both,track by_src,count 1,seconds 120;reference:url,community.rapid7.com/community/metasploit/blog/2014/08/25/r7-2014-12-more-amplification-vulnerabilities-in-ntp-allow-even-more-drdos-attacks;reference:url,en.wikipedia.org/wiki/Ephemeral_port;classtype:attempted-dos;sid:2019010;rev:3;metadata:alarm_type DDoS;)
alert udp any 123 -> any 0:1023 (msg:"可能正在进行NTP DDoS的PEER_LIST对非临时端口IMPL 0x03的响应";content:"|00 03 00|";offset:1;depth:3;byte_test:1,&,128,0;byte_test:1,&,64,0;byte_test:1,&,4,0;byte_test:1,&,2,0;byte_test:1,&,1,0;threshold: type both,track by_src,count 1,seconds 120;reference:url,community.rapid7.com/community/metasploit/blog/2014/08/25/r7-2014-12-more-amplification-vulnerabilities-in-ntp-allow-even-more-drdos-attacks;reference:url,en.wikipedia.org/wiki/Ephemeral_port;classtype:attempted-dos;sid:2019011;rev:3;metadata:alarm_type DDoS;)
alert udp any 123 -> any 0:1023 (msg:"可能正在进行NTP DDoS PEER_LIST_SUM对非临时端口IMPL 0x02的响应";content:"|00 02 01|";offset:1;depth:3;byte_test:1,&,128,0;byte_test:1,&,64,0;byte_test:1,&,4,0;byte_test:1,&,2,0;byte_test:1,&,1,0;threshold: type both,track by_src,count 1,seconds 120;reference:url,community.rapid7.com/community/metasploit/blog/2014/08/25/r7-2014-12-more-amplification-vulnerabilities-in-ntp-allow-even-more-drdos-attacks;reference:url,en.wikipedia.org/wiki/Ephemeral_port;classtype:attempted-dos;sid:2019012;rev:3;metadata:alarm_type DDoS;)
alert udp any 123 -> any 0:1023 (msg:"可能正在进行NTP DDoS PEER_LIST_SUM对非临时端口IMPL 0x03的响应";content:"|00 03 01|";offset:1;depth:3;byte_test:1,&,128,0;byte_test:1,&,64,0;byte_test:1,&,4,0;byte_test:1,&,2,0;byte_test:1,&,1,0;threshold: type both,track by_src,count 1,seconds 120;reference:url,community.rapid7.com/community/metasploit/blog/2014/08/25/r7-2014-12-more-amplification-vulnerabilities-in-ntp-allow-even-more-drdos-attacks;reference:url,en.wikipedia.org/wiki/Ephemeral_port;classtype:attempted-dos;sid:2019013;rev:3;metadata:alarm_type DDoS;)
alert udp any any -> $HOME_NET 1900 (msg:"可能正在进行SSDP放大扫描";content:"M-SEARCH * HTTP/1.1";content:"ST|3a 20|ssdp|3a|all|0d 0a|";nocase;distance:0;fast_pattern;threshold: type both,track by_src,count 2,seconds 60;reference:url,community.rapid7.com/community/metasploit/blog/2014/08/29/weekly-metasploit-update;classtype:attempted-dos;sid:2019102;rev:1;metadata:alarm_type DDoS;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"LOIC Javascript DDoS出站";flow:established,to_server;content:"GET";http_method;content:"/?id=";fast_pattern;http_uri;depth:5;content:"&msg=";http_uri;distance:13;within:5;pcre:"/^\/\?id=[0-9]{13}&msg=/U";threshold: type both, track by_src, count 5, seconds 60;reference:url,isc.sans.org/diary/Javascript+DDoS+Tool+Analysis/12442;reference:url,www.wired.com/threatlevel/2012/01/anons-rickroll-botnet;classtype:attempted-dos;sid:2014141;rev:5;metadata:alarm_type DDoS;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"LOIC POST";flow:established,to_server;content:"POST";http_method;content:"13";depth:2;http_client_body;content:"=MSG";fast_pattern;http_client_body;distance:11;within:4;pcre:"/^13\d{11}/P";threshold:type limit, track by_src, count 1, seconds 300;classtype:web-application-attack;sid:2016030;rev:4;metadata:alarm_type DDoS;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"LOIC GET";flow:established,to_server;content:"GET";http_method;content:"/?msg=MSG";http_uri;threshold:type limit, track by_src, count 1, seconds 300;classtype:web-application-attack;sid:2016031;rev:3;metadata:alarm_type DDoS;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"在已知的DDoS攻击中使用DOS用户代理检测出站";flow:established,to_server;content:"User-agent|3a| Mozilla/5.0 (Windows|3b| U|3b| Windows NT 5.1|3b| ru|3b| rv|3a|1.8.1.1) Gecko/20061204 Firefox/2.0.0.1";http_header;reference:url,www.linuxquestions.org/questions/linux-security-4/massive-ddos-need-advice-help-795298/;classtype:denial-of-service;sid:2011821;rev:3;metadata:alarm_type DDoS;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"在已知的DDoS攻击中使用DOS用户代理检测到入站";flow:established,to_server;content:"User-agent|3a| Mozilla/5.0 (Windows|3b| U|3b| Windows NT 5.1|3b| ru|3b| rv|3a|1.8.1.1) Gecko/20061204 Firefox/2.0.0.1";http_header;reference:url,www.linuxquestions.org/questions/linux-security-4/massive-ddos-need-advice-help-795298/;classtype:denial-of-service;sid:2011822;rev:3;metadata:alarm_type DDoS;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"用于已知DDoS攻击的DOS用户代理检测到出站2";flow:established,to_server;content:"User-agent|3a| Opera/9.02 (Windows NT 5.1|3b| U|3b| ru)";http_header;reference:url,www.linuxquestions.org/questions/linux-security-4/massive-ddos-need-advice-help-795298/;classtype:denial-of-service;sid:2011823;rev:3;metadata:alarm_type DDoS;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"在已知的DDoS攻击中使用DOS用户代理检测到入站2";flow:established,to_server;content:"User-agent|3a| Opera/9.02 (Windows NT 5.1|3b| U|3b| ru)";http_header;reference:url,www.linuxquestions.org/questions/linux-security-4/massive-ddos-need-advice-help-795298/;classtype:denial-of-service;sid:2011824;rev:4;metadata:alarm_type DDoS;)
alert udp any any -> $HOME_NET 53 (msg:"DNS放大攻击入站";content:"|01 00 00 01 00 00 00 00 00 01|";depth:10;offset:2;pcre:"/^[^\x00]+?\x00/R";content:"|00 ff 00 01 00 00 29|";within:7;fast_pattern;byte_test:2,>,4095,0,relative;threshold: type both, track by_dst, seconds 60, count 5;classtype:bad-unknown;sid:2016016;rev:8;metadata:alarm_type DDoS;)
alert udp any 123 -> any 0:1023 (msg:"可能正在进行NTP DDoS MON_LIST对非临时端口IMPL 0x03的响应";content:"|00 03 2a|";offset:1;depth:3;byte_test:1,&,128,0;byte_test:1,&,64,0;byte_test:1,&,4,0;byte_test:1,&,2,0;byte_test:1,&,1,0;threshold: type both,track by_src,count 1,seconds 120;reference:url,www.symantec.com/connect/blogs/hackers-spend-christmas-break-launching-large-scale-ntp-reflection-attacks;reference:url,en.wikipedia.org/wiki/Ephemeral_port;classtype:attempted-dos;sid:2017966;rev:3;metadata:alarm_type DDoS;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"Terse HTTP GET可能是GoodBye 5.2 DDoS工具";flow:to_server,established;dsize:<50;content:"|20|HTTP/1.1Host|3a 20|";threshold:type both,track by_dst,count 500,seconds 60;classtype:attempted-dos;sid:2019350;rev:2;metadata:alarm_type DDoS;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"Terse HTTP GET可能的LOIC";flow:to_server,established;dsize:18;content:"GET / HTTP/1.1|0d 0a 0d 0a|";depth:18;threshold:type both,track by_dst,count 500,seconds 60;classtype:attempted-dos;sid:2019346;rev:2;metadata:alarm_type DDoS;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"HTTP GET AAAAAAAA可能是FireFlood";flow:to_server,established;content:"GET AAAAAAAA HTTP/1.1";content:!"Referer|3a|";distance:0;content:!"Accept";distance:0;content:!"|0d 0a|";distance:0;threshold:type both,track by_dst,count 500,seconds 60;classtype:attempted-dos;sid:2019347;rev:2;metadata:alarm_type DDoS;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"Terse HTTP GET可能是AnonMafiaIC DDoS工具";flow:to_server,established;dsize:20;content:"GET / HTTP/1.0|0d 0a 0d 0a 0d 0a|";depth:20;threshold:type both,track by_dst,count 500,seconds 60;classtype:attempted-dos;sid:2019348;rev:2;metadata:alarm_type DDoS;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"Terse HTTP GET可能是AnonGhost DDoS工具";flow:to_server,established;dsize:20;content:"GET / HTTP/1.1|0d 0a 0d 0a 0d 0a|";depth:20;threshold:type both,track by_dst,count 500,seconds 60;classtype:attempted-dos;sid:2019349;rev:2;metadata:alarm_type DDoS;)
alert udp any 123 -> any 0:1023 (msg:"可能正在进行NTP DDoS GET_RESTRICT对非临时端口IMPL 0x03的响应";content:"|00 03 10|";offset:1;depth:3;byte_test:1,&,128,0;byte_test:1,&,64,0;byte_test:1,&,4,0;byte_test:1,&,2,0;byte_test:1,&,1,0;threshold: type both,track by_src,count 1,seconds 120;reference:url,community.rapid7.com/community/metasploit/blog/2014/08/25/r7-2014-12-more-amplification-vulnerabilities-in-ntp-allow-even-more-drdos-attacks;reference:url,en.wikipedia.org/wiki/Ephemeral_port;classtype:attempted-dos;sid:2019014;rev:4;metadata:alarm_type DDoS;)
alert udp any 123 -> any 0:1023 (msg:"可能正在进行NTP DDoS GET_RESTRICT对非临时端口IMPL 0x02的响应";content:"|00 02 10|";offset:1;depth:3;byte_test:1,&,128,0;byte_test:1,&,64,0;byte_test:1,&,4,0;byte_test:1,&,2,0;byte_test:1,&,1,0;threshold: type both,track by_src,count 1,seconds 120;reference:url,community.rapid7.com/community/metasploit/blog/2014/08/25/r7-2014-12-more-amplification-vulnerabilities-in-ntp-allow-even-more-drdos-attacks;reference:url,en.wikipedia.org/wiki/Ephemeral_port;classtype:attempted-dos;sid:2019015;rev:4;metadata:alarm_type DDoS;)
alert udp any any -> any 123 (msg:"可能的NTP DDoS入站频繁未经授权的PEER_LIST请求IMPL 0x03";content:"|00 03 00|";offset:1;depth:3;byte_test:1,!&,128,0;byte_test:1,&,4,0;byte_test:1,&,2,0;byte_test:1,&,1,0;threshold: type both,track by_dst,count 2,seconds 60;reference:url,community.rapid7.com/community/metasploit/blog/2014/08/25/r7-2014-12-more-amplification-vulnerabilities-in-ntp-allow-even-more-drdos-attacks;classtype:attempted-dos;sid:2019016;rev:3;metadata:alarm_type DDoS;)
alert udp any any -> any 123 (msg:"可能的NTP DDoS入站频繁未经授权的PEER_LIST请求IMPL 0x02";content:"|00 02 00|";offset:1;depth:3;byte_test:1,!&,128,0;byte_test:1,&,4,0;byte_test:1,&,2,0;byte_test:1,&,1,0;threshold: type both,track by_dst,count 2,seconds 60;reference:url,community.rapid7.com/community/metasploit/blog/2014/08/25/r7-2014-12-more-amplification-vulnerabilities-in-ntp-allow-even-more-drdos-attacks;classtype:attempted-dos;sid:2019017;rev:3;metadata:alarm_type DDoS;)
alert udp any any -> any 123 (msg:"可能的NTP DDoS入站频繁未经授权的PEER_LIST_SUM请求IMPL 0x03";content:"|00 03 01|";offset:1;depth:3;byte_test:1,!&,128,0;byte_test:1,&,4,0;byte_test:1,&,2,0;byte_test:1,&,1,0;threshold: type both,track by_dst,count 2,seconds 60;reference:url,community.rapid7.com/community/metasploit/blog/2014/08/25/r7-2014-12-more-amplification-vulnerabilities-in-ntp-allow-even-more-drdos-attacks;classtype:attempted-dos;sid:2019018;rev:3;metadata:alarm_type DDoS;)
alert udp any any -> any 123 (msg:"可能的NTP DDoS入站频繁未经授权的PEER_LIST_SUM请求IMPL 0x02";content:"|00 02 01|";offset:1;depth:3;byte_test:1,!&,128,0;byte_test:1,&,4,0;byte_test:1,&,2,0;byte_test:1,&,1,0;threshold: type both,track by_dst,count 2,seconds 60;reference:url,community.rapid7.com/community/metasploit/blog/2014/08/25/r7-2014-12-more-amplification-vulnerabilities-in-ntp-allow-even-more-drdos-attacks;classtype:attempted-dos;sid:2019019;rev:3;metadata:alarm_type DDoS;)
alert udp any any -> any 123 (msg:"可能的NTP DDoS入站频繁未经授权的GET_RESTRICT请求IMPL 0x02";content:"|00 02 10|";offset:1;depth:3;byte_test:1,!&,128,0;byte_test:1,&,4,0;byte_test:1,&,2,0;byte_test:1,&,1,0;threshold: type both,track by_dst,count 2,seconds 60;reference:url,community.rapid7.com/community/metasploit/blog/2014/08/25/r7-2014-12-more-amplification-vulnerabilities-in-ntp-allow-even-more-drdos-attacks;classtype:attempted-dos;sid:2019021;rev:3;metadata:alarm_type DDoS;)
alert udp any any -> any 123 (msg:"可能的NTP DDoS入站频繁未经授权的GET_RESTRICT请求IMPL 0x03";content:"|00 03 10|";offset:1;depth:3;byte_test:1,!&,128,0;byte_test:1,&,4,0;byte_test:1,&,2,0;byte_test:1,&,1,0;threshold: type both,track by_dst,count 2,seconds 60;reference:url,community.rapid7.com/community/metasploit/blog/2014/08/25/r7-2014-12-more-amplification-vulnerabilities-in-ntp-allow-even-more-drdos-attacks;classtype:attempted-dos;sid:2019020;rev:3;metadata:alarm_type DDoS;)
alert udp any 123 -> any any (msg:"可能正在进行NTP DDoS多个UNSETTRAP模式6响应";content:"|df 00 00 04 00|";offset:1;depth:5;byte_test:1,!&,128,0;byte_test:1,!&,64,0;byte_test:1,&,4,0;byte_test:1,&,2,0;byte_test:1,!&,1,0;threshold: type both,track by_src,count 2,seconds 60;reference:url,community.rapid7.com/community/metasploit/blog/2014/08/25/r7-2014-12-more-amplification-vulnerabilities-in-ntp-allow-even-more-drdos-attacks;classtype:attempted-dos;sid:2019022;rev:4;metadata:alarm_type DDoS;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"进行中的DOS可能的WordPress Pingback DDoS（入站）";flow:established,to_server;content:"/xmlrpc.php";http_uri;nocase;content:"pingback.ping";nocase;http_client_body;fast_pattern;threshold:type both, track by_src, count 5, seconds 90;classtype:attempted-dos;sid:2018277;rev:3;metadata:alarm_type DDoS;)
alert udp $HOME_NET 1434 -> $EXTERNAL_NET any (msg:"MC-SQLR响应出站可能的DDoS参与";content:"|05|";depth:1;content:"ServerName|3b|";nocase;content:"InstanceName|3b|";distance:0;content:"IsClustered|3b|";distance:0;content:"Version|3b|";distance:0;threshold:type both,track by_src,count 30,seconds 60;reference:url,kurtaubuchon.blogspot.com.es/2015/01/mc-sqlr-amplification-ms-sql-server.html;classtype:attempted-dos;sid:2020305;rev:4;metadata:alarm_type DDoS;)
alert udp $EXTERNAL_NET 1434 -> $HOME_NET any (msg:"MC-SQLR响应入站可能的DDoS目标";content:"|05|";depth:1;content:"ServerName|3b|";nocase;content:"InstanceName|3b|";distance:0;content:"IsClustered|3b|";distance:0;content:"Version|3b|";distance:0;threshold:type both,track by_dst,count 30,seconds 60;reference:url,kurtaubuchon.blogspot.com.es/2015/01/mc-sqlr-amplification-ms-sql-server.html;classtype:attempted-dos;sid:2020306;rev:3;metadata:alarm_type DDoS;)
alert udp $HOME_NET 5093 -> $EXTERNAL_NET any (msg:"可能正在进行的Sentinal LM应用程序攻击出站（响应）";dsize:>1390;content:"|7a 00 00 00 00 00 00 00 00 00 00 00|";depth:12;threshold: type both,track by_src,count 10,seconds 60;classtype:attempted-dos;sid:2021170;rev:1;metadata:alarm_type DDoS;)
alert udp $EXTERNAL_NET 5093 -> $HOME_NET any (msg:"可能的Sentinal LM放大攻击（响应）入站";dsize:>1390;content:"|7a 00 00 00 00 00 00 00 00 00 00 00|";depth:12;threshold: type both,track by_src,count 10,seconds 60;classtype:attempted-dos;sid:2021171;rev:1;metadata:alarm_type DDoS;)
alert udp $EXTERNAL_NET any -> $HOME_NET 5093 (msg:"可能的Sentinal LM放大攻击（请求）入站";dsize:6;content:"|7a 00 00 00 00 00|";threshold: type both,track by_dst,count 10,seconds 60;classtype:attempted-dos;sid:2021172;rev:1;metadata:alarm_type DDoS;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"Linux /海啸DOS用户代理（x00_-gawa.sa.pilipinas.2015）内置";flow:to_server,established;content:"x00_-gawa.sa.pilipinas.2015";http_user_agent;reference:url,vms.drweb.com/virus/?i=4656268;classtype:attempted-dos;sid:2022760;rev:2;metadata:alarm_type DDoS;)
alert udp $HOME_NET 53 -> $EXTERNAL_NET 1:1023 (msg:"DNS放大攻击可能出站Windows非递归根提示保留端口";content:"|81 00 00 01 00 00|";depth:6;offset:2;byte_test:2,>,10,0,relative;byte_test:2,>,10,2,relative;content:"|0c|root-servers|03|net|00|";distance:0;content:"|0c|root-servers|03|net|00|";distance:0;threshold: type both, track by_dst, seconds 60, count 5;reference:url,twitter.com/sempersecurus/status/763749835421941760;reference:url,pastebin.com/LzubgtVb;classtype:bad-unknown;sid:2023054;rev:2;metadata:alarm_type DDoS;)
alert udp $EXTERNAL_NET 53 -> $HOME_NET 1:1023 (msg:"DNS放大攻击可能是入站Windows非递归根提示保留端口";content:"|81 00 00 01 00 00|";depth:6;offset:2;byte_test:2,>,10,0,relative;byte_test:2,>,10,2,relative;content:"|0c|root-servers|03|net|00|";distance:0;content:"|0c|root-servers|03|net|00|";distance:0;threshold: type both, track by_dst, seconds 60, count 5;reference:url,twitter.com/sempersecurus/status/763749835421941760;reference:url,pastebin.com/LzubgtVb;classtype:bad-unknown;sid:2023053;rev:2;metadata:alarm_type DDoS;)
alert tcp any 445 -> $HOME_NET any (msg:"过多的大树连接响应";flow:from_server,established;byte_test: 3,>,1000,1;content: "|fe 53 4d 42 40 00|";offset: 4;depth: 6;content: "|03 00|";offset: 16;depth:2;reference:url,isc.sans.edu/forums/diary/Windows+SMBv3+Denial+of+Service+Proof+of+Concept+0+Day+Exploit/22029/;classtype:attempted-dos;sid:2023831;rev:2;metadata:alarm_type DDoS;)
alert tcp any 445 -> $HOME_NET any (msg:"SMB Tree_Connect堆栈溢出尝试（CVE-2017-0016）";flow:from_server,established;content:"|FE|SMB";offset:4;depth:4;content:"|03 00|";distance:8;within:2;byte_test:1,&,1,2,relative;byte_jump:2,8,little,from_beginning;byte_jump:2,4,relative,little;isdataat:1000,relative;content:!"|FE|SMB";within:1000;reference:cve,2017-0016;classtype:attempted-dos;sid:2023832;rev:3;metadata:alarm_type DDoS;)
alert tcp any any -> $HOME_NET 445 (msg:"Microsoft Windows LSASS远程内存损坏（CVE-2017-0004）";flow:established,to_server;content:"|FF|SMB|73|";offset:4;depth:5;byte_test:1,&,0x80,6,relative;byte_test:1,&,0x08,6,relative;byte_test:1,&,0x10,5,relative;byte_test:1,&,0x04,5,relative;byte_test:1,&,0x02,5,relative;byte_test:1,&,0x01,5,relative;content:"|ff 00|";distance:28;within:2;content:"|84|";distance:25;within:1;content:"NTLMSSP";fast_pattern;within:64;reference:url,github.com/lgandx/PoC/tree/master/LSASS;reference:url,support.microsoft.com/en-us/kb/3216771;reference:url,support.microsoft.com/en-us/kb/3199173;reference:cve,2017-0004;reference:url,technet.microsoft.com/library/security/MS17-004;classtype:attempted-dos;sid:2023497;rev:3;metadata:alarm_type DDoS;)
alert tcp any any -> $HOME_NET [139,445] (msg:"SMBLoris NBSS长度内存用尽尝试（基于PoC）";flow:established,to_server;content:"|00 01 ff ff|";depth:4;threshold:type both,track by_dst,count 30, seconds 300;reference:url,isc.sans.edu/forums/diary/SMBLoris+the+new+SMB+flaw/22662/;classtype:trojan-activity;sid:2024511;rev:2;metadata:alarm_type DDoS;)
alert udp $EXTERNAL_NET 389 -> $HOME_NET 389 (msg:"CLDAP放大反射（基于PoC）";dsize:52;content:"|30 84 00 00 00 2d 02 01 01 63 84 00 00 00 24 04 00 0a 01 00|";fast_pattern;threshold:type both, count 100, seconds 60, track by_src;reference:url,www.akamai.com/us/en/multimedia/documents/state-of-the-internet/cldap-threat-advisory.pdf;reference:url,packetstormsecurity.com/files/139561/LDAP-Amplication-Denial-Of-Service.html;classtype:attempted-dos;sid:2024584;rev:1;metadata:alarm_type DDoS;)
alert udp $EXTERNAL_NET any -> $HOME_NET 389 (msg:"潜在的CLDAP放大反映";content:"objectclass0";fast_pattern;threshold:type both, count 200, seconds 60, track by_src;reference:url,www.akamai.com/us/en/multimedia/documents/state-of-the-internet/cldap-threat-advisory.pdf;reference:url,packetstormsecurity.com/files/139561/LDAP-Amplication-Denial-Of-Service.html;classtype:attempted-dos;sid:2024585;rev:1;metadata:alarm_type DDoS;)
alert udp $EXTERNAL_NET any -> any 11211 (msg:"可能的Memcached DDoS放大查询（设置）";content:"|00 00 00 00 00 01 00|";depth:7;fast_pattern;content:"|0d 0a|";distance:0;within:20;isdataat:!1,relative;threshold: type both, count 100, seconds 60, track by_dst;flowbits:set,ET.memcached.ddos;reference:url,blog.cloudflare.com/memcrashed-major-amplification-attacks-from-port-11211/;classtype:attempted-dos;sid:2025401;rev:2;metadata:alarm_type DDoS;)
alert udp any 11211 -> $EXTERNAL_NET any (msg:"可能的Memcached DDoS放大响应出站";flowbits:isset,ET.memcached.ddos;content:"STATS|20|pid";depth:9;fast_pattern;threshold: type both, count 100, seconds 60, track by_dst;reference:url,blog.cloudflare.com/memcrashed-major-amplification-attacks-from-port-11211/;classtype:attempted-dos;sid:2025402;rev:1;metadata:alarm_type DDoS;)
alert udp $EXTERNAL_NET 11211 -> $HOME_NET any (msg:"可能的Memcached DDoS放大入站";content:"STATS|20|pid";depth:9;fast_pattern;threshold: type both, count 100, seconds 60, track by_dst;reference:url,blog.cloudflare.com/memcrashed-major-amplification-attacks-from-port-11211/;classtype:attempted-dos;sid:2025403;rev:1;metadata:alarm_type DDoS;)
alert udp $EXTERNAL_NET any -> $HOME_NET 1900 (msg:"LibuPnP CVE-2012-5958 ST DeviceType缓冲区溢出";content:"|0D 0A|ST|3a|";nocase;pcre:"/^[^\r\n]*schemas\x3adevice\x3a[^\r\n\x3a]{181}/Ri";content:"schemas|3a|device";nocase;fast_pattern;reference:cve,CVE_2012-5958;reference:cve,CVE-2012-5962;classtype:attempted-dos;sid:2016322;rev:2;metadata:alarm_type DDoS;)
alert udp $EXTERNAL_NET any -> $HOME_NET 1900 (msg:"LibuPnP CVE-2012-5964 ST URN ServiceType缓冲区溢出";content:"|0D 0A|ST|3a|";nocase;pcre:"/^[^\r\n]*urn\x3aservice\x3a[^\r\n\x3a]{181}/Ri";content:"urn|3a|service";nocase;fast_pattern;reference:cve,CVE-2012-5964;classtype:attempted-dos;sid:2016324;rev:2;metadata:alarm_type DDoS;)
alert udp $EXTERNAL_NET any -> $HOME_NET 1900 (msg:"LibuPnP CVE-2012-5965 ST URN DeviceType缓冲区溢出";content:"|0D 0A|ST|3a|";nocase;pcre:"/^[^\r\n]*urn\x3adevice\x3a[^\r\n\x3a]{181}/Ri";content:"urn|3a|device";nocase;fast_pattern;reference:cve,CVE-2012-5965;classtype:attempted-dos;sid:2016325;rev:2;metadata:alarm_type DDoS;)
alert udp $EXTERNAL_NET any -> $HOME_NET 1900 (msg:"LibuPnP CVE-2012-5961 ST UDN缓冲区溢出";content:"|0D 0A|ST|3a|";nocase;pcre:"/^[^\r\n]*schemas\x3adevice\x3a[^\r\n\x3a]{1,180}\x3a[^\r\n\x3a]{181}/Ri";content:"schemas|3a|device";nocase;fast_pattern;reference:cve,CVE-2012-5961;classtype:attempted-dos;sid:2016326;rev:2;metadata:alarm_type DDoS;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"Bittorrent用户代理入站-可能的DDOS";flow:established,to_server;content:"Bittorrent";http_user_agent;depth:10;threshold: type both, count 1, seconds 60, track by_src;reference:url,torrentfreak.com/zombie-pirate-bay-tracker-fuels-chinese-ddos-attacks-150124/;classtype:attempted-dos;sid:2020702;rev:3;metadata:alarm_type DDoS;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"HOIC带有助推器出站";flow:to_server,established;content:"GET";http_method;content:"If-Modified-Since|3a 20 20|";http_raw_header;content:"Keep-Alive|3a 20 20|";http_raw_header;content:"Connection|3a 20 20|";http_raw_header;content:"User-Agent|3a 20 20|";http_raw_header;http_start;content:"HTTP/1.0|0d 0a|Accept|3a 20|*/*|0d 0a|Accept-Language|3a 20|";threshold: type both, count 1, seconds 60, track by_src;reference:md5,23fc64a5cac4406d7143ea26e8c4c7ab;reference:url,blog.spiderlabs.com/2012/01/hoic-ddos-analysis-and-detection.html;classtype:trojan-activity;sid:2018977;rev:4;metadata:alarm_type DDoS;)
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"HOIC，带有增强的入站";flow:to_server,established;content:"GET";http_method;content:"If-Modified-Since|3a 20 20|";http_raw_header;content:"Keep-Alive|3a 20 20|";http_raw_header;content:"Connection|3a 20 20|";http_raw_header;content:"User-Agent|3a 20 20|";http_raw_header;http_start;content:"HTTP/1.0|0d 0a|Accept|3a 20|*/*|0d 0a|Accept-Language|3a 20|";threshold: type both, count 1, seconds 60, track by_dst;reference:md5,23fc64a5cac4406d7143ea26e8c4c7ab;reference:url,blog.spiderlabs.com/2012/01/hoic-ddos-analysis-and-detection.html;classtype:trojan-activity;sid:2018978;rev:3;metadata:alarm_type DDoS;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"高轨道离子加农炮（HOIC）攻击入站通用检测双间距UA";flow:established,to_server;content:"User-Agent|3a 20 20|";http_raw_header;fast_pattern;threshold: type both, track by_src, count 225, seconds 60;reference:url,blog.spiderlabs.com/2012/01/hoic-ddos-analysis-and-detection.html;classtype:attempted-dos;sid:2014153;rev:7;metadata:alarm_type DDoS;)
alert http $EXTERNAL_NET any -> any any (msg:"CallStranger-尝试了具有多个回调的UPnP反映放大TCP（CVE-2020-12695）";flow:established,to_server;content:"SUBSCRIBE";http_method;content:"CALLBACK|3a|";http_header;fast_pattern;nocase;content:"<http";http_header;distance:0;content:"<http";http_header;distance:0;pcre:"/^Callback\x3a\x20<http[^>]+><http/Hmi";reference:url,github.com/yunuscadirci/CallStranger;reference:cve,2020-12695;classtype:attempted-dos;sid:2030339;rev:2;metadata:alarm_type DDoS;)
